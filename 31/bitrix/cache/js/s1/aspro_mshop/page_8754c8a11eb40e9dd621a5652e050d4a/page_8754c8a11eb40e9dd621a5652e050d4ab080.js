
; /* Start:"a:4:{s:4:"full";s:98:"/bitrix/templates/aspro_mshop/components/bitrix/catalog.element/main/script.min.js?151963403773170";s:6:"source";s:78:"/bitrix/templates/aspro_mshop/components/bitrix/catalog.element/main/script.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
var ItemObj={};$(document).on("click",".item-stock .store_view",function(){scroll_block($(".tabs_section"))}),$(document).ready(function(){$(".opener").click(function(){$(this).find(".opener_icon").toggleClass("opened"),$(this).parents("tr").toggleClass("nb").next(".offer_stores").find(".stores_block_wrap").slideToggle(200)}),$(".tabs_section .tabs-head li").live("click",function(){$(this).is(".current")||($(".tabs_section .tabs-head li").removeClass("current"),$(this).addClass("current"),$(".tabs_section ul.tabs_content li").removeClass("current"),"product_reviews_tab"==$(this).attr("id")?($(".shadow.common").hide(),$("#reviews_content").show()):($(".shadow.common").show(),$("#reviews_content").hide(),$(".tabs_section ul.tabs_content > li:eq("+$(this).index()+")").addClass("current")))}),$(".hint .icon").click(function(t){var i=$(this).parents(".hint");i.click(function(t){t.stopPropagation()}),i.is(".active")?i.removeClass("active").find(".tooltip").slideUp(200):($(".catalog_detail .hint").removeClass("active"),$(".catalog_detail .hint .tooltip").slideUp(100),i.addClass("active").find(".tooltip").slideDown(200),i.find(".tooltip_close").click(function(t){t.stopPropagation(),i.removeClass("active").find(".tooltip").slideUp(100)}),$(document).click(function(){i.removeClass("active").find(".tooltip").slideUp(100)}))})}),$(".set_block").ready(function(){$(".set_block ").equalize({children:'.item:not(".r") .cost',reset:!0}),$(".set_block").equalize({children:".item .item-title",reset:!0}),$(".set_block").equalize({children:".item .item_info",reset:!1})}),function(t){if(t.JCCatalogOnlyElement||(t.JCCatalogOnlyElement=function(t){"object"==typeof t&&(this.params=t,this.obProduct=null,this.set_quantity=1,this.currentPriceMode="",this.currentPrices=[],this.currentPriceSelected=0,this.currentQuantityRanges=[],this.currentQuantityRangeSelected=0,this.params.MESS&&(this.mess=this.params.MESS),this.init())},t.JCCatalogOnlyElement.prototype={init:function(){this.obProduct=BX(this.params.ID),this.obProduct&&($(this.obProduct).find(".counter_wrapp .counter_block input").data("product","ob"+this.obProduct.id+"el"),this.currentPriceMode=this.params.ITEM_PRICE_MODE,this.currentPrices=this.params.ITEM_PRICES,this.currentQuantityRanges=this.params.ITEM_QUANTITY_RANGES)},setPriceAction:function(){this.set_quantity=this.params.MIN_QUANTITY_BUY,$(this.obProduct).find("input[name=quantity]").length&&(this.set_quantity=$(this.obProduct).find("input[name=quantity]").val()),this.checkPriceRange(this.set_quantity),$(this.obProduct).find(".not_matrix").hide(),$(this.obProduct).find(".with_matrix .price_value_block").html(getCurrentPrice(this.currentPrices[this.currentPriceSelected].PRICE,this.currentPrices[this.currentPriceSelected].CURRENCY,this.currentPrices[this.currentPriceSelected].PRINT_PRICE)),$(this.obProduct).find(".with_matrix .discount")&&$(this.obProduct).find(".with_matrix .discount").html(getCurrentPrice(this.currentPrices[this.currentPriceSelected].BASE_PRICE,this.currentPrices[this.currentPriceSelected].CURRENCY,this.currentPrices[this.currentPriceSelected].PRINT_BASE_PRICE)),$(this.obProduct).find(".with_matrix .sale_block .text .values_wrapper").html(getCurrentPrice(this.currentPrices[this.currentPriceSelected].DISCOUNT,this.currentPrices[this.currentPriceSelected].CURRENCY,this.currentPrices[this.currentPriceSelected].PRINT_DISCOUNT)),$(this.obProduct).find(".with_matrix .sale_block .value span").html(this.currentPrices[this.currentPriceSelected].PERCENT),$(this.obProduct).find(".with_matrix").show(),"Y"==arMShopOptions.THEME.SHOW_TOTAL_SUMM&&void 0!==this.currentPrices[this.currentPriceSelected]&&void 0!==this.currentPrices[this.currentPriceSelected].PRICE&&this.currentPrices[this.currentPriceSelected].PRICE&&setPriceItem($(this.obProduct),this.set_quantity,this.currentPrices[this.currentPriceSelected].PRICE)},checkPriceRange:function(t){if(void 0!==t&&"Q"==this.currentPriceMode){var i,s=!1;for(var e in this.currentQuantityRanges)if(this.currentQuantityRanges.hasOwnProperty(e)&&(i=this.currentQuantityRanges[e],parseInt(t)>=parseInt(i.SORT_FROM)&&("INF"==i.SORT_TO||parseInt(t)<=parseInt(i.SORT_TO)))){s=!0,this.currentQuantityRangeSelected=i.HASH;break}!s&&(i=this.getMinPriceRange())&&(this.currentQuantityRangeSelected=i.HASH);for(var a in this.currentPrices)if(this.currentPrices.hasOwnProperty(a)&&this.currentPrices[a].QUANTITY_HASH==this.currentQuantityRangeSelected){this.currentPriceSelected=a;break}}},getMinPriceRange:function(){var t;for(var i in this.currentQuantityRanges)this.currentQuantityRanges.hasOwnProperty(i)&&(!t||parseInt(this.currentQuantityRanges[i].SORT_FROM)<parseInt(t.SORT_FROM))&&(t=this.currentQuantityRanges[i]);return t}}),!t.JCCatalogElement){var i=function(t){i.superclass.constructor.apply(this,arguments),this.nameNode=BX.create("span",{props:{className:"bx_medium bx_bt_button",id:this.id},style:"object"==typeof t.style?t.style:{},text:t.text}),this.buttonNode=BX.create("span",{attrs:{className:t.ownerClass},children:[this.nameNode],events:this.contextEvents}),BX.browser.IsIE()&&this.buttonNode.setAttribute("hideFocus","hidefocus")};BX.extend(i,BX.PopupWindowButton),t.JCCatalogElement=function(t){if(this.skuVisualParams={SELECT:{TAG_BIND:"select",TAG:"option",ACTIVE_CLASS:"active",HIDE_CLASS:"hidden",EVENT:"change"},LI:{TAG_BIND:"li",TAG:"li",ACTIVE_CLASS:"active",HIDE_CLASS:"missing",EVENT:"click"}},this.productType=0,this.config={useCatalog:!0,showQuantity:!0,showPrice:!0,showAbsent:!0,showOldPrice:!1,showPercent:!1,showSkuProps:!1,showOfferGroup:!1,useCompare:!1,mainPictureMode:"IMG",showBasisPrice:!1,basketAction:["BUY"],showClosePopup:!1},this.basketLinkURL="",this.checkQuantity=!1,this.maxQuantity=0,this.SliderImages=0,this.defaultCount=1,this.stepQuantity=1,this.isDblQuantity=!1,this.canBuy=!0,this.currentBasisPrice={},this.canSubscription=!0,this.currentIsSet=!1,this.updateViewedCount=!1,this.currentPriceMode="",this.currentPrices=[],this.currentPriceSelected=0,this.currentQuantityRanges=[],this.currentQuantityRangeSelected=0,this.precision=6,this.precisionFactor=Math.pow(10,this.precision),this.listID={main:["PICT_ID","BIG_SLIDER_ID","BIG_IMG_CONT_ID"],stickers:["STICKER_ID"],productSlider:["SLIDER_CONT","SLIDER_LIST","SLIDER_LEFT","SLIDER_RIGHT"],offerSlider:["SLIDER_CONT_OF_ID","SLIDER_LIST_OF_ID","SLIDER_LEFT_OF_ID","SLIDER_RIGHT_OF_ID"],offerSliderMobile:["SLIDER_CONT_OFM_ID","SLIDER_LIST_OFM_ID","SLIDER_LEFT_OFM_ID","SLIDER_RIGHT_OFM_ID"],offers:["TREE_ID","TREE_ITEM_ID","DISPLAY_PROP_DIV","DISPLAY_PROP_ARTICLE_DIV","OFFER_GROUP"],quantity:["QUANTITY_ID","QUANTITY_UP_ID","QUANTITY_DOWN_ID","QUANTITY_MEASURE","QUANTITY_LIMIT","BASIS_PRICE"],price:["PRICE_ID"],oldPrice:["OLD_PRICE_ID","DISCOUNT_VALUE_ID"],discountPerc:["DISCOUNT_PERC_ID"],basket:["BASKET_PROP_DIV","BUY_ID","BASKET_LINK","ADD_BASKET_ID","BASKET_ACTIONS_ID","NOT_AVAILABLE_MESS","SUBSCRIBE_ID","SUBSCRIBED_ID"],magnifier:["MAGNIFIER_ID","MAGNIFIER_AREA_ID"],compare:["COMPARE_LINK_ID"]},this.visualPostfix={PICT_ID:"_pict",BIG_SLIDER_ID:"_big_slider",BIG_IMG_CONT_ID:"_bigimg_cont",STICKER_ID:"_sticker",SLIDER_CONT:"_slider_cont",SLIDER_LIST:"_slider_list",SLIDER_LEFT:"_slider_left",SLIDER_RIGHT:"_slider_right",SLIDER_CONT_OF_ID:"_slider_cont_",SLIDER_LIST_OF_ID:"_slider_list_",SLIDER_LEFT_OF_ID:"_slider_left_",SLIDER_RIGHT_OF_ID:"_slider_right_",SLIDER_CONT_OFM_ID:"_sliderm_cont_",SLIDER_LIST_OFM_ID:"_sliderm_list_",SLIDER_LEFT_OFM_ID:"_sliderm_left_",SLIDER_RIGHT_OFM_ID:"_sliderm_right_",TREE_ID:"_skudiv",TREE_ITEM_ID:"_prop_",DISPLAY_PROP_DIV:"_sku_prop",DISPLAY_PROP_ARTICLE_DIV:"_sku_article_prop",QUANTITY_ID:"_quantity",QUANTITY_UP_ID:"_quant_up",QUANTITY_DOWN_ID:"_quant_down",QUANTITY_MEASURE:"_quant_measure",QUANTITY_LIMIT:"_quant_limit",BASIS_PRICE:"_basis_price",PRICE_ID:"_price",OLD_PRICE_ID:"_old_price",DISCOUNT_VALUE_ID:"_price_discount",DISCOUNT_PERC_ID:"_dsc_pict",BASKET_PROP_DIV:"_basket_prop",BUY_ID:"_buy_link",BASKET_LINK:"_basket_link",ADD_BASKET_ID:"_add_basket_link",BASKET_ACTIONS_ID:"_basket_actions",NOT_AVAILABLE_MESS:"_not_avail",SUBSCRIBE_ID:"_subscribe_div",SUBSCRIBED_ID:"_subscribed_div",MAGNIFIER_ID:"_magnifier",MAGNIFIER_AREA_ID:"_magnifier_area",OFFER_GROUP:"_set_group_",COMPARE_LINK_ID:"_compare_link"},this.visual={},this.basketMode="",this.product={checkQuantity:!1,maxQuantity:0,stepQuantity:1,startQuantity:1,isDblQuantity:!1,canBuy:!0,canSubscription:!0,name:"",pict:{},id:0,addUrl:"",buyUrl:"",slider:{},sliderCount:0,useSlider:!1,sliderPict:[]},this.mess={},this.basketData={useProps:!1,emptyProps:!1,quantity:"quantity",props:"prop",basketUrl:"",sku_props:"",sku_props_var:"basket_props",add_url:"",buy_url:""},this.compareData={compareUrl:"",comparePath:""},this.defaultPict={preview:null,detail:null},this.offers=[],this.offerNum=0,this.treeProps=[],this.obTreeRows=[],this.showCount=[],this.showStart=[],this.selectedValues={},this.sliders=[],this.obProduct=null,this.obQuantity=null,this.obQuantityUp=null,this.obQuantityDown=null,this.obBasisPrice=null,this.obPict=null,this.obPictAligner=null,this.obPrice={price:null,full:null,discount:null,percent:null},this.obTree=null,this.obBuyBtn=null,this.obBasketBtn=null,this.obAddToBasketBtn=null,this.obBasketActions=null,this.obNotAvail=null,this.obSkuProps=null,this.obSlider=null,this.obMeasure=null,this.obQuantityLimit={all:null,value:null},this.obCompare=null,this.viewedCounter={path:"/bitrix/components/bitrix/catalog.element/ajax.php",params:{AJAX:"Y",SITE_ID:"",PRODUCT_ID:0,PARENT_ID:0}},this.currentImg={src:"",width:0,height:0,screenWidth:0,screenHeight:0,screenOffsetX:0,screenOffsetY:0,scale:1},this.currentBigImg={src:""},this.obPopupWin=null,this.basketUrl="",this.basketParams={},this.obPopupPict=null,this.magnify={obMagnifier:null,obMagnifyPict:null,obMagnifyArea:null,obBigImg:null,obBigSlider:null,magnifyShow:!1,areaParams:{width:100,height:130,left:0,top:0,scaleFactor:1,globalLeft:0,globalTop:0,globalRight:0,globalBottom:0},magnifierParams:{top:0,left:0,width:0,height:0,ratioX:10,ratioY:13,defaultScale:1},magnifyPictParams:{marginTop:0,marginLeft:0,width:0,height:0}},this.treeRowShowSize=5,this.treeEnableArrow={display:"",cursor:"pointer",opacity:1},this.treeDisableArrow={display:"",cursor:"default",opacity:.2},this.sliderRowShowSize=5,this.sliderEnableArrow={display:"",cursor:"pointer",opacity:1},this.sliderDisableArrow={display:"",cursor:"default",opacity:.2},this.errorCode=0,"object"==typeof t){switch(this.params=t,this.initConfig(),this.params.MESS&&(this.mess=this.params.MESS),this.productType){case 0:case 1:case 2:this.initProductData();break;case 3:this.initOffersData();break;default:this.errorCode=-1}this.initBasketData(),this.initCompareData()}0===this.errorCode&&BX.ready(BX.delegate(this.Init,this)),this.params={}},t.JCCatalogElement.prototype.Init=function(){var t=0,i=0,s="",e=null,a=null;if(this.obProduct=BX(this.visual.ID),this.obProduct||(this.errorCode=-1),this.obPict=BX(this.visual.PICT_ID),this.obPict?this.obPictAligner=this.obPict.parentNode:this.errorCode=-2,this.config.showPrice&&(this.obPrice.price=BX(this.visual.PRICE_ID),!this.obPrice.price&&this.config.useCatalog?this.errorCode=-16:(this.config.showOldPrice&&(this.obPrice.full=BX(this.visual.OLD_PRICE_ID),this.obPrice.discount=BX(this.visual.DISCOUNT_VALUE_ID),this.obPrice.full&&BX.adjust(this.obPrice.full,{style:{display:"none"},html:""})),this.config.showPercent&&(this.obPrice.percent=BX(this.visual.DISCOUNT_PERC_ID))),this.obBasketActions=BX(this.visual.BASKET_ACTIONS_ID),this.obBasketActions&&(BX.util.in_array("BUY",this.config.basketAction)&&(this.obBuyBtn=BX(this.visual.BUY_ID)),BX.util.in_array("ADD",this.config.basketAction)&&(this.obAddToBasketBtn=BX(this.visual.BUY_ID)),this.visual.BASKET_LINK&&(this.obBasketBtn=BX(this.visual.BASKET_LINK))),this.obNotAvail=BX(this.visual.NOT_AVAILABLE_MESS)),this.config.showQuantity&&(this.obQuantity=BX(this.visual.QUANTITY_ID),this.visual.QUANTITY_UP_ID&&(this.obQuantityUp=BX(this.visual.QUANTITY_UP_ID)),this.visual.QUANTITY_DOWN_ID&&(this.obQuantityDown=BX(this.visual.QUANTITY_DOWN_ID)),this.config.showBasisPrice&&(this.obBasisPrice=BX(this.visual.BASIS_PRICE))),3===this.productType){if(this.visual.TREE_ID)for(this.obTree=BX(this.visual.TREE_ID),this.obTree||(this.errorCode=-256),s=this.visual.TREE_ITEM_ID,t=0;t<this.treeProps.length;t++)if(this.obTreeRows[t]={LEFT:BX(s+this.treeProps[t].ID+"_left"),RIGHT:BX(s+this.treeProps[t].ID+"_right"),LIST:BX(s+this.treeProps[t].ID+"_list"),CONT:BX(s+this.treeProps[t].ID+"_cont")},!this.obTreeRows[t].LIST||!this.obTreeRows[t].CONT){this.errorCode=-512;break}this.visual.QUANTITY_MEASURE&&(this.obMeasure=BX(this.visual.QUANTITY_MEASURE)),this.visual.QUANTITY_LIMIT&&(this.obQuantityLimit.all=BX(this.visual.QUANTITY_LIMIT),this.obQuantityLimit.all&&(this.obQuantityLimit.value=BX.findChild(this.obQuantityLimit.all,{tagName:"span"},!1,!1),this.obQuantityLimit.value||(this.obQuantityLimit.all=null)))}if(this.config.showSkuProps&&(this.visual.DISPLAY_PROP_DIV&&(this.obSkuProps=BX(this.visual.DISPLAY_PROP_DIV)),this.visual.DISPLAY_PROP_ARTICLE_DIV&&(this.obSkuArticleProps=BX(this.visual.DISPLAY_PROP_ARTICLE_DIV))),this.config.useCompare&&(this.obCompare=BX(this.visual.COMPARE_LINK_ID)),0===this.errorCode){switch(this.config.showQuantity&&(this.obQuantityUp&&BX.bind(this.obQuantityUp,"click",BX.delegate(this.QuantityUp,this)),this.obQuantityDown&&BX.bind(this.obQuantityDown,"click",BX.delegate(this.QuantityDown,this)),this.obQuantity&&BX.bind(this.obQuantity,"change",BX.delegate(this.QuantityChange,this))),this.productType){case 0:case 1:case 2:if(this.product.useSlider){if(this.product.slider={COUNT:this.product.sliderCount,ID:this.visual.SLIDER_CONT,CONT:BX(this.visual.SLIDER_CONT),LIST:BX(this.visual.SLIDER_LIST),LEFT:BX(this.visual.SLIDER_LEFT),RIGHT:BX(this.visual.SLIDER_RIGHT),START:0},(e=BX.findChildren(this.product.slider.LIST,{tagName:"li"},!0))&&0<e.length)for(i=0;i<e.length;i++)BX.bind(e[i],"click",BX.delegate(this.ProductSelectSliderImg,this));this.product.slider.LEFT&&(BX.bind(this.product.slider.LEFT,"click",BX.delegate(this.ProductSliderRowLeft,this)),BX.adjust(this.product.slider.LEFT,{style:this.sliderDisableArrow})),this.product.slider.RIGHT&&(BX.bind(this.product.slider.RIGHT,"click",BX.delegate(this.ProductSliderRowRight,this)),BX.adjust(this.product.slider.RIGHT,{style:this.sliderEnableArrow})),this.setCurrentImg(this.product.sliderPict[0],!0)}break;case 3:for(var r in this.skuVisualParams){if((a=BX.findChildren(this.obTree,{tagName:this.skuVisualParams[r].TAG_BIND},!0))&&0<a.length)for(t=0;t<a.length;t++)$(a[t]).on(this.skuVisualParams[r].EVENT,BX.delegate(this.SelectOfferProp,this))}for(t=0;t<this.offers.length;t++)if(this.offers[t].SLIDER_COUNT=parseInt(this.offers[t].SLIDER_COUNT,10),isNaN(this.offers[t].SLIDER_COUNT)&&(this.offers[t].SLIDER_COUNT=0),0===this.offers[t].SLIDER_COUNT)this.sliders[t]={COUNT:this.offers[t].SLIDER_COUNT,ID:""};else{for(i=0;i<this.offers[t].SLIDER.length;i++)this.offers[t].SLIDER[i].WIDTH=parseInt(this.offers[t].SLIDER[i].WIDTH,10),this.offers[t].SLIDER[i].HEIGHT=parseInt(this.offers[t].SLIDER[i].HEIGHT,10);if(this.sliders[t]={COUNT:this.offers[t].SLIDER_COUNT,OFFER_ID:this.offers[t].ID,ID:this.visual.SLIDER_CONT_OF_ID+this.offers[t].ID,CONT:BX(this.visual.SLIDER_CONT_OF_ID+this.offers[t].ID),LIST:BX(this.visual.SLIDER_LIST_OF_ID+this.offers[t].ID),CONT_M:BX(this.visual.SLIDER_CONT_OFM_ID+this.offers[t].ID),LIST_M:BX(this.visual.SLIDER_LIST_OFM_ID+this.offers[t].ID),LEFT:BX(this.visual.SLIDER_LEFT_OF_ID+this.offers[t].ID),RIGHT:BX(this.visual.SLIDER_RIGHT_OF_ID+this.offers[t].ID),START:0},(e=BX.findChildren(this.sliders[t].LIST,{tagName:"li"},!0))&&0<e.length)for(i=0;i<e.length;i++)BX.bind(e[i],"click",BX.delegate(this.SelectSliderImg,this));this.sliders[t].LEFT&&BX.bind(this.sliders[t].LEFT,"click",BX.delegate(this.SliderRowLeft,this)),this.sliders[t].RIGHT&&BX.bind(this.sliders[t].RIGHT,"click",BX.delegate(this.SliderRowRight,this))}this.SetCurrent()}this.obBuyBtn&&BX.bind(this.obBuyBtn,"click",BX.proxy(this.BuyBasket,this)),this.obAddToBasketBtn&&BX.bind(this.obAddToBasketBtn,"click",BX.proxy(this.Add2Basket,this)),this.obCompare&&BX.bind(this.obCompare,"click",BX.proxy(this.Compare,this)),this.setMainPictHandler(),setTimeout(function(){$(".offers_img.wof").css("opacity",1)},400)}},t.JCCatalogElement.prototype.initConfig=function(){this.productType=parseInt(this.params.PRODUCT_TYPE,10),this.params.CONFIG&&"object"==typeof this.params.CONFIG?("undefined"!==this.params.CONFIG.USE_CATALOG&&BX.type.isBoolean(this.params.CONFIG.USE_CATALOG)&&(this.config.useCatalog=this.params.CONFIG.USE_CATALOG),this.config.showQuantity=!!this.params.CONFIG.SHOW_QUANTITY,this.config.showPrice=!!this.params.CONFIG.SHOW_PRICE,this.config.showPercent=!!this.params.CONFIG.SHOW_DISCOUNT_PERCENT,this.config.showOldPrice=!!this.params.CONFIG.SHOW_OLD_PRICE,this.config.showSkuProps=!!this.params.CONFIG.SHOW_SKU_PROPS,this.config.showOfferGroup=!!this.params.CONFIG.OFFER_GROUP,this.config.useCompare=!!this.params.CONFIG.DISPLAY_COMPARE,this.params.CONFIG.MAIN_PICTURE_MODE&&(this.config.mainPictureMode=this.params.CONFIG.MAIN_PICTURE_MODE),this.config.showBasisPrice=!!this.params.CONFIG.SHOW_BASIS_PRICE,this.params.CONFIG.ADD_TO_BASKET_ACTION&&(this.config.basketAction=this.params.CONFIG.ADD_TO_BASKET_ACTION),this.config.showClosePopup=!!this.params.CONFIG.SHOW_CLOSE_POPUP):("undefined"!==this.params.USE_CATALOG&&BX.type.isBoolean(this.params.USE_CATALOG)&&(this.config.useCatalog=this.params.USE_CATALOG),this.config.showQuantity=!!this.params.SHOW_QUANTITY,this.config.showPrice=!!this.params.SHOW_PRICE,this.config.showPercent=!!this.params.SHOW_DISCOUNT_PERCENT,this.config.showOldPrice=!!this.params.SHOW_OLD_PRICE,this.config.showSkuProps=!!this.params.SHOW_SKU_PROPS,this.config.showOfferGroup=!!this.params.OFFER_GROUP,this.config.useCompare=!!this.params.DISPLAY_COMPARE,this.params.MAIN_PICTURE_MODE&&(this.config.mainPictureMode=this.params.MAIN_PICTURE_MODE),this.config.showBasisPrice=!!this.params.SHOW_BASIS_PRICE,this.params.ADD_TO_BASKET_ACTION&&(this.config.basketAction=this.params.ADD_TO_BASKET_ACTION),this.config.showClosePopup=!!this.params.SHOW_CLOSE_POPUP),this.params.VISUAL&&"object"==typeof this.params.VISUAL&&this.params.VISUAL.ID?(this.visual.ID=this.params.VISUAL.ID,this.basketLinkURL=this.params.BASKET.BASKET_URL,this.defaultCount=this.params.DEFAULT_COUNT,this.storeQuanity=BX(this.params.STORE_QUANTITY),this.initVisualParams("main"),this.config.showQuantity&&this.initVisualParams("quantity"),this.config.showPrice&&this.initVisualParams("price"),this.config.showOldPrice&&this.initVisualParams("oldPrice"),this.config.showPercent&&this.initVisualParams("discountPerc"),this.initVisualParams("basket"),"MAGNIFIER"===this.config.mainPictureMode&&this.initVisualParams("magnifier"),this.config.useCompare&&this.initVisualParams("compare")):this.errorCode=-1},t.JCCatalogElement.prototype.initVisualParams=function(t){var i=0,s="";if(this.listID[t])for(i=0;i<this.listID[t].length;i++)s=this.listID[t][i],this.visual[s]=this.params.VISUAL[s]?this.params.VISUAL[s]:this.visual.ID+this.visualPostfix[s];else this.errorCode=-1},t.JCCatalogElement.prototype.initProductData=function(){var t=0;if(this.initVisualParams("productSlider"),this.params.PRODUCT&&"object"==typeof this.params.PRODUCT){if(this.config.showQuantity&&(this.product.checkQuantity=this.params.PRODUCT.CHECK_QUANTITY,this.product.isDblQuantity=this.params.PRODUCT.QUANTITY_FLOAT,this.product.checkQuantity&&(this.product.maxQuantity=this.product.isDblQuantity?parseFloat(this.params.PRODUCT.MAX_QUANTITY):parseInt(this.params.PRODUCT.MAX_QUANTITY,10)),this.product.stepQuantity=this.product.isDblQuantity?parseFloat(this.params.PRODUCT.STEP_QUANTITY):parseInt(this.params.PRODUCT.STEP_QUANTITY,10),this.checkQuantity=this.product.checkQuantity,this.isDblQuantity=this.product.isDblQuantity,this.maxQuantity=this.product.maxQuantity,this.stepQuantity=this.product.stepQuantity,this.isDblQuantity&&(this.stepQuantity=Math.round(this.stepQuantity*this.precisionFactor)/this.precisionFactor)),this.product.canBuy=this.params.PRODUCT.CAN_BUY,this.product.canSubscription=this.params.PRODUCT.SUBSCRIPTION,this.config.showPrice&&(this.currentBasisPrice=this.params.PRODUCT.BASIS_PRICE),this.canBuy=this.product.canBuy,this.canSubscription=this.product.canSubscription,this.product.name=this.params.PRODUCT.NAME,this.product.pict=this.params.PRODUCT.PICT,this.product.id=this.params.PRODUCT.ID,this.params.PRODUCT.ADD_URL&&(this.product.addUrl=this.params.PRODUCT.ADD_URL),this.params.PRODUCT.BUY_URL&&(this.product.buyUrl=this.params.PRODUCT.BUY_URL),this.params.PRODUCT.SLIDER_COUNT&&(this.product.sliderCount=parseInt(this.params.PRODUCT.SLIDER_COUNT,10),isNaN(this.product.sliderCount)&&(this.product.sliderCount=0),0<this.product.sliderCount&&this.params.PRODUCT.SLIDER.length&&0<this.params.PRODUCT.SLIDER.length)){for(t=0;t<this.params.PRODUCT.SLIDER.length;t++)this.product.useSlider=!0,this.params.PRODUCT.SLIDER[t].WIDTH=parseInt(this.params.PRODUCT.SLIDER[t].WIDTH,10),this.params.PRODUCT.SLIDER[t].HEIGHT=parseInt(this.params.PRODUCT.SLIDER[t].HEIGHT,10);this.product.sliderPict=this.params.PRODUCT.SLIDER,this.setCurrentImg(this.product.sliderPict[0],!1)}this.currentIsSet=!0}else this.errorCode=-1},t.JCCatalogElement.prototype.initOffersData=function(){if(this.initVisualParams("offerSlider"),this.initVisualParams("offerSliderMobile"),this.initVisualParams("offers"),this.params.OFFERS&&BX.type.isArray(this.params.OFFERS)){if(this.offers=this.params.OFFERS,this.offerNum=0,this.params.OFFER_SELECTED&&(this.offerNum=parseInt(this.params.OFFER_SELECTED,10),"offers"in this&&this.offers.length)){var t=parseUrlQuery(),i=(this.params.SKU_DETAIL_ID,0);if("oid"in t&&(i=t.oid),i)for(var s in this.offers)this.offers[s].ID==i&&(this.offerNum=parseInt(s,10))}isNaN(this.offerNum)&&(this.offerNum=0),this.params.TREE_PROPS&&(this.treeProps=this.params.TREE_PROPS),this.params.DEFAULT_PICTURE&&(this.defaultPict.preview=this.params.DEFAULT_PICTURE.PREVIEW_PICTIRE,this.defaultPict.detail=this.params.DEFAULT_PICTURE.DETAIL_PICTURE),this.params.PRODUCT&&"object"==typeof this.params.PRODUCT&&(this.product.id=parseInt(this.params.PRODUCT.ID,10),this.product.name=this.params.PRODUCT.NAME)}else this.errorCode=-1},t.JCCatalogElement.prototype.initBasketData=function(){this.params.BASKET&&"object"==typeof this.params.BASKET&&(1!==this.productType&&2!==this.productType||(this.basketData.useProps=!!this.params.BASKET.ADD_PROPS,this.basketData.emptyProps=!!this.params.BASKET.EMPTY_PROPS),this.params.BASKET.QUANTITY&&(this.basketData.quantity=this.params.BASKET.QUANTITY),this.params.BASKET.PROPS&&(this.basketData.props=this.params.BASKET.PROPS),this.params.BASKET.BASKET_URL&&(this.basketData.basketUrl=this.params.BASKET.BASKET_URL),3===this.productType&&this.params.BASKET.SKU_PROPS&&(this.basketData.sku_props=this.params.BASKET.SKU_PROPS),this.params.BASKET.ADD_URL_TEMPLATE&&(this.basketData.add_url=this.params.BASKET.ADD_URL_TEMPLATE),this.params.BASKET.BUY_URL_TEMPLATE&&(this.basketData.buy_url=this.params.BASKET.BUY_URL_TEMPLATE),""===this.basketData.add_url&&""===this.basketData.buy_url&&(this.errorCode=-1024))},t.JCCatalogElement.prototype.initCompareData=function(){this.config.useCompare&&(this.params.COMPARE&&"object"==typeof this.params.COMPARE?(this.params.COMPARE.COMPARE_PATH&&(this.compareData.comparePath=this.params.COMPARE.COMPARE_PATH),this.params.COMPARE.COMPARE_URL_TEMPLATE_DEL&&(this.compareData.compareUrlDel=this.params.COMPARE.COMPARE_URL_TEMPLATE_DEL),this.params.COMPARE.COMPARE_URL_TEMPLATE?this.compareData.compareUrl=this.params.COMPARE.COMPARE_URL_TEMPLATE:this.config.useCompare=!1):this.config.useCompare=!1)},t.JCCatalogElement.prototype.setMainPictHandler=function(){switch(this.config.mainPictureMode){case"GALLERY":break;case"MAGNIFIER":this.magnify.obBigImg=BX(this.visual.BIG_IMG_CONT_ID),this.magnify.obBigSlider=BX(this.visual.BIG_SLIDER_ID),this.magnify.obBigImg&&this.magnify.obBigSlider&&(this.magnify.obMagnifyArea=this.obPictAligner.appendChild(BX.create("DIV",{props:{id:this.visual.MAGNIFIER_AREA_ID,className:"bx_item_slider_lupe_small"},style:{display:"none",top:0,left:0,width:"100px",height:"130px"},events:{mouseover:BX.delegate(this.onMagnifierArea,this),mouseout:BX.delegate(function(){this.outMagnifierArea(),this.hideMagnifier()},this)}})),this.magnify.obMagnifier=this.magnify.obBigSlider.appendChild(BX.create("DIV",{props:{id:this.visual.MAGNIFIER_ID,className:"bx_item_slider_lupe"},style:{display:"none"}})),this.magnify.obMagnifyPict=this.magnify.obMagnifier.appendChild(BX.create("IMG",{props:{src:this.currentImg.src}})),BX.bind(this.obPict,"mouseover",BX.delegate(this.showMagnifier,this)));break;case"POPUP":this.obPopupPict=new BX.PopupWindow("CatalogElementPopup_"+this.visual.ID,null,{autoHide:!1,offsetLeft:0,offsetTop:0,overlay:!1,closeByEsc:!0,titleBar:!0,closeIcon:{top:"10px",right:"10px"}}),BX.bind(this.obPict,"click",BX.delegate(this.showMainPictPopup,this)),BX.adjust(this.obPict,{style:{cursor:"pointer"}}),BX.addCustomEvent(this.obPopupPict,"onAfterPopupShow",BX.proxy(this.onPopupWindowShow,this)),BX.addCustomEvent(this.obPopupPict,"onPopupClose",BX.proxy(this.onPopupWindowClose,this))}},t.JCCatalogElement.prototype.setCurrentImg=function(t,i){if(i=!!i,"SMALL"in t?this.currentImg.src=t.SMALL.src:"SRC"in t&&(this.currentImg.src=t.SRC),"BIG"in t&&(this.currentBigImg.src=t.BIG.src),"WIDTH"in t&&(this.currentImg.width=t.WIDTH),"HEIGHT"in t&&(this.currentImg.height=t.HEIGHT),i&&this.obPict){"MAGNIFIER"===this.config.mainPictureMode&&(this.outMagnifierArea(),this.hideMagnifier()),"src"in this.currentImg&&this.currentImg.src&&BX.adjust(this.obPict,{props:{src:this.currentImg.src}}),"src"in this.currentBigImg&&this.currentBigImg.src&&($(this.obPict).parent().attr("href",this.currentBigImg.src),$(this.obPict).parent().attr("title",t.TITLE),$(this.obPict).parent().attr("alt",t.ALT),$(this.obPict).attr("title",t.TITLE),$(this.obPict).attr("alt",t.ALT));parseInt(this.obPictAligner.offsetWidth,10),parseInt(this.obPictAligner.offsetHeight,10)}},t.JCCatalogElement.prototype.scaleImg=function(t,i){var s,e,a,r={};return i.width>=t.width&&i.height>=t.height?(r.width=t.width,r.height=t.height):(s=i.width/t.width,e=i.height/t.height,a=Math.min(s,e),r.width=Math.max(1,parseInt(a*t.width,10)),r.height=Math.max(1,parseInt(a*t.height,10))),r},t.JCCatalogElement.prototype.showMagnifier=function(t){this.magnify.magnifyShow||(this.calcMagnifierParams(),this.calcMagnifyAreaSize(),this.calcMagnifyAreaPos(t),this.calcMagnifyPictSize(),this.calcMagnifyPictPos(),this.setMagnifyAreaParams(!0),this.setMagnifyPictParams(!0),this.setMagnifierParams(!0),BX.bind(document,"mousemove",BX.proxy(this.moveMagnifierArea,this)))},t.JCCatalogElement.prototype.hideMagnifier=function(){this.magnify.magnifyShow||(this.magnify.obMagnifier&&BX.adjust(this.magnify.obMagnifier,{style:{display:"none"}}),this.magnify.obMagnifyArea&&BX.adjust(this.magnify.obMagnifyArea,{style:{display:"none"}}),BX.unbind(document,"mousemove",BX.proxy(this.moveMagnifierArea,this)))},t.JCCatalogElement.prototype.moveMagnifierArea=function(t){var i,s=BX.pos(this.obPict),e={},a={},r={};if(i=this.inRect(t,s),this.inBound(s,i)){switch((e=this.intersectArea(i,s)).X){case-1:this.magnify.areaParams.left=this.currentImg.screenOffsetX;break;case 0:this.magnify.areaParams.left=this.currentImg.screenOffsetX+i.X-(this.magnify.areaParams.width>>>1);break;case 1:this.magnify.areaParams.left=this.currentImg.screenOffsetX+s.width-this.magnify.areaParams.width}switch(e.Y){case-1:this.magnify.areaParams.top=0;break;case 0:this.magnify.areaParams.top=i.Y-(this.magnify.areaParams.height>>>1);break;case 1:this.magnify.areaParams.top=s.height-this.magnify.areaParams.height}this.magnify.magnifyPictParams.marginLeft=-parseInt((this.magnify.areaParams.left-this.currentImg.screenOffsetX)*this.currentImg.scale,10),this.magnify.magnifyPictParams.marginTop=-parseInt(this.magnify.areaParams.top*this.currentImg.scale,10),a.left=this.magnify.areaParams.left+"px",a.top=this.magnify.areaParams.top+"px",BX.adjust(this.magnify.obMagnifyArea,{style:a}),r.marginLeft=this.magnify.magnifyPictParams.marginLeft+"px",r.marginTop=this.magnify.magnifyPictParams.marginTop+"px",BX.adjust(this.magnify.obMagnifyPict,{style:r})}else this.outMagnifierArea(),this.hideMagnifier()},t.JCCatalogElement.prototype.onMagnifierArea=function(){this.magnify.magnifyShow=!0},t.JCCatalogElement.prototype.outMagnifierArea=function(){this.magnify.magnifyShow=!1},t.JCCatalogElement.prototype.calcMagnifierParams=function(){if(this.magnify.obBigImg){var t=BX.pos(this.magnify.obBigImg,!0);this.magnify.magnifierParams.width=t.width,this.magnify.magnifierParams.height=t.height,this.magnify.magnifierParams.top=t.top,this.magnify.magnifierParams.left=t.left+t.width+2}},t.JCCatalogElement.prototype.setMagnifierParams=function(t){if(this.magnify.obMagnifier){t=!!t;var i={top:this.magnify.magnifierParams.top+"px",left:this.magnify.magnifierParams.left+"px",width:this.magnify.magnifierParams.width+"px",height:this.magnify.magnifierParams.height+"px"};t&&(i.display=""),BX.adjust(this.magnify.obMagnifier,{style:i})}},t.JCCatalogElement.prototype.setMagnifyAreaParams=function(t){if(this.magnify.obMagnifier){t=!!t;var i={top:this.magnify.areaParams.top+"px",left:this.magnify.areaParams.left+"px",width:this.magnify.areaParams.width+"px",height:this.magnify.areaParams.height+"px"};t&&(i.display=""),BX.adjust(this.magnify.obMagnifyArea,{style:i})}},t.JCCatalogElement.prototype.calcMagnifyAreaPos=function(t){var i,s,e;if(s=BX.pos(this.obPict),i=this.inRect(t,s),this.inBound(s,i)){switch((e=this.intersectArea(i,s)).X){case-1:this.magnify.areaParams.left=this.currentImg.screenOffsetX;break;case 0:this.magnify.areaParams.left=this.currentImg.screenOffsetX+i.X-(this.magnify.areaParams.width>>>1);break;case 1:this.magnify.areaParams.left=this.currentImg.screenOffsetX+s.width-this.magnify.areaParams.width}switch(e.Y){case-1:this.magnify.areaParams.top=0;break;case 0:this.magnify.areaParams.top=i.Y-(this.magnify.areaParams.height>>>1);break;case 1:this.magnify.areaParams.top=s.height-this.magnify.areaParams.height}}},t.JCCatalogElement.prototype.inBound=function(t,i){return 0<=i.Y&&t.height>=i.Y&&0<=i.X&&t.width>=i.X},t.JCCatalogElement.prototype.inRect=function(t,i){var s=BX.GetWindowSize(),e={X:0,Y:0,globalX:0,globalY:0};return e.globalX=t.clientX+s.scrollLeft,e.X=e.globalX-i.left,e.globalY=t.clientY+s.scrollTop,e.Y=e.globalY-i.top,e},t.JCCatalogElement.prototype.intersectArea=function(t,i){var s={X:0,Y:0},e=this.magnify.areaParams.width>>>1,a=this.magnify.areaParams.height>>>1;return t.X<=e?s.X=-1:t.X>=i.width-e?s.X=1:s.X=0,t.Y<=a?s.Y=-1:t.Y>=i.height-a?s.Y=1:s.Y=0,s},t.JCCatalogElement.prototype.calcMagnifyAreaSize=function(){var t,i,s;this.magnify.magnifierParams.width<this.currentImg.width&&this.magnify.magnifierParams.height<this.currentImg.height?(t=this.magnify.obBigImg.offsetWidth/this.currentImg.width,i=this.magnify.obBigImg.offsetHeight/this.currentImg.height,s=Math.min(t,i),this.currentImg.scale=1/s,this.magnify.areaParams.width=Math.max(1,parseInt(s*this.magnify.magnifierParams.width,10)),this.magnify.areaParams.height=Math.max(1,parseInt(s*this.magnify.magnifierParams.height,10)),this.magnify.areaParams.scaleFactor=this.magnify.magnifierParams.defaultScale):(t=this.obPict.offsetWidth/this.magnify.obBigImg.offsetWidth,i=this.obPict.offsetHeight/this.magnify.obBigImg.offsetHeight,s=Math.min(t,i),this.currentImg.scale=1/s,this.magnify.areaParams.width=Math.max(1,parseInt(s*this.magnify.magnifierParams.width,10)),this.magnify.areaParams.height=Math.max(1,parseInt(s*this.magnify.magnifierParams.height,10)),t=this.magnify.magnifierParams.width/this.currentImg.width,i=this.magnify.magnifierParams.height/this.currentImg.height,s=Math.max(t,i),this.magnify.areaParams.scaleFactor=s)},t.JCCatalogElement.prototype.calcMagnifyPictSize=function(){this.magnify.magnifyPictParams.width=this.currentImg.width*this.magnify.areaParams.scaleFactor,this.magnify.magnifyPictParams.height=this.currentImg.height*this.magnify.areaParams.scaleFactor},t.JCCatalogElement.prototype.calcMagnifyPictPos=function(){this.magnify.magnifyPictParams.marginLeft=-parseInt((this.magnify.areaParams.left-this.currentImg.screenOffsetX)*this.currentImg.scale,10),this.magnify.magnifyPictParams.marginTop=-parseInt(this.magnify.areaParams.top*this.currentImg.scale,10)},t.JCCatalogElement.prototype.setMagnifyPictParams=function(t){if(this.magnify.obMagnifier){t=!!t;var i={width:this.magnify.magnifyPictParams.width+"px",height:this.magnify.magnifyPictParams.height+"px",marginTop:this.magnify.magnifyPictParams.marginTop+"px",marginLeft:this.magnify.magnifyPictParams.marginLeft+"px"};t&&(i.display=""),BX.adjust(this.magnify.obMagnifyPict,{style:i,props:{src:this.currentImg.src}})}},t.JCCatalogElement.prototype.ProductSliderRowLeft=function(){BX.proxy_context&&this.sliderRowShowSize<this.product.slider.COUNT&&(0>this.product.slider.START&&(this.product.slider.START++,BX.adjust(this.product.slider.LIST,{style:{marginLeft:20*this.product.slider.START+"%"}}),BX.adjust(this.product.slider.RIGHT,{style:this.sliderEnableArrow})),0<=this.product.slider.START&&BX.adjust(this.product.slider.LEFT,{style:this.sliderDisableArrow}))},t.JCCatalogElement.prototype.ProductSliderRowRight=function(){BX.proxy_context&&this.sliderRowShowSize<this.product.slider.COUNT&&(this.sliderRowShowSize-this.product.slider.START<this.product.slider.COUNT&&(this.product.slider.START--,BX.adjust(this.product.slider.LIST,{style:{marginLeft:20*this.product.slider.START+"%"}}),BX.adjust(this.product.slider.LEFT,{style:this.sliderEnableArrow})),this.sliderRowShowSize-this.product.slider.START>=this.product.slider.COUNT&&BX.adjust(this.product.slider.RIGHT,{style:this.sliderDisableArrow}))},t.JCCatalogElement.prototype.ProductSelectSliderImg=function(){var t="",i=BX.proxy_context;i&&i.hasAttribute("data-value")&&(t=i.getAttribute("data-value"),this.SetProductMainPict(t))},t.JCCatalogElement.prototype.SetProductMainPict=function(t){var i=-1,s=0,e=0,a="",r=null;if(0<this.product.sliderCount){for(e=0;e<this.product.sliderPict.length;e++)if(t===this.product.sliderPict[e].ID){i=e;break}if(-1<i&&(this.product.sliderPict[i]&&this.setCurrentImg(this.product.sliderPict[i],!0),(r=BX.findChildren(this.product.slider.LIST,{tagName:"li"},!1))&&0<r.length))for(a=t,s=0;s<r.length;s++)r[s].getAttribute("data-value")===a?BX.addClass(r[s],"active"):BX.removeClass(r[s],"active")}},t.JCCatalogElement.prototype.SliderRowLeft=function(){var t,i="",s=-1,e=BX.proxy_context;if(e&&e.hasAttribute("data-value")){for(i=e.getAttribute("data-value"),t=0;t<this.sliders.length;t++)if(this.sliders[t].OFFER_ID===i){s=t;break}-1<s&&this.sliderRowShowSize<this.sliders[s].COUNT&&(0>this.sliders[s].START&&(this.sliders[s].START++,BX.adjust(this.sliders[s].LIST,{style:{marginLeft:20*this.sliders[s].START+"%"}}),BX.adjust(this.sliders[s].RIGHT,{style:this.sliderEnableArrow})),0<=this.sliders[s].START&&BX.adjust(this.sliders[s].LEFT,{style:this.sliderDisableArrow}))}},t.JCCatalogElement.prototype.SliderRowRight=function(){var t,i="",s=-1,e=BX.proxy_context;if(e&&e.hasAttribute("data-value")){for(i=e.getAttribute("data-value"),t=0;t<this.sliders.length;t++)if(this.sliders[t].OFFER_ID===i){s=t;break}-1<s&&this.sliderRowShowSize<this.sliders[s].COUNT&&(this.sliderRowShowSize-this.sliders[s].START<this.sliders[s].COUNT&&(this.sliders[s].START--,BX.adjust(this.sliders[s].LIST,{style:{marginLeft:20*this.sliders[s].START+"%"}}),BX.adjust(this.sliders[s].LEFT,{style:this.sliderEnableArrow})),this.sliderRowShowSize-this.sliders[s].START>=this.sliders[s].COUNT&&BX.adjust(this.sliders[s].RIGHT,{style:this.sliderDisableArrow}))}},t.JCCatalogElement.prototype.SelectSliderImg=function(){var t=[],i=BX.proxy_context;i&&i.hasAttribute("data-value")&&(t=i.getAttribute("data-value").split("_"),this.SetMainPict(t[0],t[1]))},t.JCCatalogElement.prototype.SetMainPict=function(i,s){var e,a,r=-1,o=-1,n=null,h="";for(e=0;e<this.offers.length;e++)if(i===this.offers[e].ID){r=e;break}if($(t).resize(),$(".thumbs_navigation ul").addClass("hidden_block"),this.SliderImages>1&&$(".thumbs_navigation ul:eq("+r+")").removeClass("hidden_block"),$(".thumbs_navigation").removeClass("hidden_block"),$(".fancy_offer").addClass("hidden_block"),$(this.obPict).closest(".offers_img").css("opacity",0),-1<r&&0<this.offers[r].SLIDER_COUNT){for(a=0;a<this.offers[r].SLIDER.length;a++)if(s===this.offers[r].SLIDER[a].ID){o=a;break}if(-1<o&&(this.offers[r].SLIDER[o]&&this.setCurrentImg(this.offers[r].SLIDER[o],!0),(n=BX.findChildren(this.sliders[r].LIST,{tagName:"li"},!1))&&0<n.length))for(h=i+"_"+s,e=0;e<n.length;e++)n[e].getAttribute("data-value")===h?BX.addClass(n[e],"current"):BX.removeClass(n[e],"current")}setTimeout(function(){$(".fancy_offer").removeClass("hidden_block"),$(".offers_img").css("opacity",1)},200)},t.JCCatalogElement.prototype.SetMainPictFromItem=function(t){if(this.obPict){var i=!1,s={};this.offers[t]&&(this.offers[t].DETAIL_PICTURE?(s=this.offers[t].DETAIL_PICTURE,i=!0):this.offers[t].PREVIEW_PICTURE&&(s=this.offers[t].PREVIEW_PICTURE,i=!0)),i||(this.defaultPict.detail?(s=this.defaultPict.detail,i=!0):this.defaultPict.preview&&(s=this.defaultPict.preview,i=!0)),i&&this.setCurrentImg(s,!0)}},t.JCCatalogElement.prototype.showMainPictPopup=function(t){var i;return i='<div style="text-align: center;"><img src="'+this.currentImg.src+'" width="'+this.currentImg.width+'" height="'+this.currentImg.height+'" name=""></div>',this.obPopupPict.setContent(i),this.obPopupPict.show(),BX.PreventDefault(t)},t.JCCatalogElement.prototype.QuantityUp=function(){var t=0,i=!0;0===this.errorCode&&this.config.showQuantity&&this.canBuy&&(t=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10),isNaN(t)||(t+=this.stepQuantity,this.checkQuantity&&t>this.maxQuantity&&(i=!1),i&&(this.isDblQuantity&&(t=Math.round(t*this.precisionFactor)/this.precisionFactor),this.obQuantity.value=t)))},t.JCCatalogElement.prototype.QuantityDown=function(){var t=0,i=!0;0===this.errorCode&&this.config.showQuantity&&this.canBuy&&(t=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10),isNaN(t)||((t-=this.stepQuantity)<this.stepQuantity&&(i=!1),i&&(this.isDblQuantity&&(t=Math.round(t*this.precisionFactor)/this.precisionFactor),this.obQuantity.value=t)))},t.JCCatalogElement.prototype.QuantityChange=function(){var t,i,s=0;0===this.errorCode&&this.config.showQuantity&&(this.canBuy?(s=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10),isNaN(s)?this.obQuantity.value=this.stepQuantity:(this.checkQuantity&&s>this.maxQuantity&&(s=this.maxQuantity),s<this.stepQuantity?s=this.stepQuantity:(i=Math.round(s*this.precisionFactor/this.stepQuantity)/this.precisionFactor,t=parseInt(i,10),isNaN(t)&&(t=1,i=1.1),i>t&&(s=t<=1?this.stepQuantity:t*this.stepQuantity,s=Math.round(s*this.precisionFactor)/this.precisionFactor)),this.obQuantity.value=s)):this.obQuantity.value=this.stepQuantity)},t.JCCatalogElement.prototype.QuantitySet=function(t){var i,s="";0===this.errorCode&&(this.canBuy=this.offers[t].CAN_BUY,this.currentPriceMode=this.offers[t].ITEM_PRICE_MODE,this.currentPrices=this.offers[t].ITEM_PRICES,this.currentPriceSelected=this.offers[t].ITEM_PRICE_SELECTED,this.currentQuantityRanges=this.offers[t].ITEM_QUANTITY_RANGES,this.currentQuantityRangeSelected=this.offers[t].ITEM_QUANTITY_RANGE_SELECTED,this.canBuy?(this.obBasketActions&&BX.style(this.obBasketActions,"display",""),this.obNotAvail&&BX.style(this.obNotAvail,"display","none")):(this.obBasketActions&&(BX.style(this.obBasketActions,"opacity","0"),BX.style(BX.findParent(BX(this.obQuantity),{class:"counter_block"}),"display","none")),this.obNotAvail&&BX.style(this.obNotAvail,"display","")),this.config.showQuantity&&(this.isDblQuantity=this.offers[t].QUANTITY_FLOAT,this.checkQuantity=this.offers[t].CHECK_QUANTITY,this.isDblQuantity?(this.maxQuantity=parseFloat(this.offers[t].MAX_QUANTITY),this.stepQuantity=Math.round(parseFloat(this.offers[t].STEP_QUANTITY)*this.precisionFactor)/this.precisionFactor):(this.maxQuantity=parseInt(this.offers[t].MAX_QUANTITY,10),this.stepQuantity=parseInt(this.offers[t].STEP_QUANTITY,10)),this.obMeasure&&(this.offers[t].MEASURE?BX.adjust(this.obMeasure,{html:this.offers[t].MEASURE}):BX.adjust(this.obMeasure,{html:""})),this.obQuantityLimit.all&&(this.checkQuantity?(i=this.offers[t].MAX_QUANTITY,this.offers[t].MEASURE&&(i+=" "+this.offers[t].MEASURE),BX.adjust(this.obQuantityLimit.value,{html:i}),BX.adjust(this.obQuantityLimit.all,{style:{display:""}})):(BX.adjust(this.obQuantityLimit.value,{html:""}),BX.adjust(this.obQuantityLimit.all,{style:{display:"none"}}))),this.obBasisPrice&&(this.offers[t].BASIS_PRICE?(s=(s=(s=BX.message("BASIS_PRICE_MESSAGE")).replace("#PRICE#",BX.Currency.currencyFormat(this.offers[t].BASIS_PRICE.DISCOUNT_VALUE,this.offers[t].BASIS_PRICE.CURRENCY,!0))).replace("#MEASURE#",this.offers[t].MEASURE),BX.adjust(this.obBasisPrice,{style:{display:""},html:s})):BX.adjust(this.obBasisPrice,{style:{display:"none"},html:""}))),this.currentBasisPrice=this.offers[t].BASIS_PRICE)},t.JCCatalogElement.prototype.SelectOfferProp=function(){var t=0,i="",s=[],e=null,a=BX.proxy_context;if(void 0!==a.options&&void 0!==a.options[a.selectedIndex]&&(a=a.options[a.selectedIndex]),a&&a.hasAttribute("data-treevalue")&&(i=a.getAttribute("data-treevalue"),propModes=a.getAttribute("data-showtype"),s=i.split("_"),this.SearchOfferPropIndex(s[0],s[1]),(e=BX.findChildren(a.parentNode,{tagName:this.skuVisualParams[propModes.toUpperCase()].TAG},!1))&&0<e.length))for(t=0;t<e.length;t++)value=e[t].getAttribute("data-onevalue"),"TEXT"==propModes?value===s[1]?e[t].setAttribute("selected","selected"):e[t].removeAttribute("selected"):value===s[1]?$(e[t]).addClass(this.skuVisualParams[propModes.toUpperCase()].ACTIVE_CLASS):$(e[t]).removeClass(this.skuVisualParams[propModes.toUpperCase()].ACTIVE_CLASS)},t.JCCatalogElement.prototype.SearchOfferPropIndex=function(t,i){var s,e,a="",r=!1,o=[],n=[],h=-1,c={},l=[];for(s=0;s<this.treeProps.length;s++)if(this.treeProps[s].ID===t){h=s;break}if(-1<h){for(s=0;s<h;s++)c[a="PROP_"+this.treeProps[s].ID]=this.selectedValues[a];for(c[a="PROP_"+this.treeProps[h].ID]=i,s=h+1;s<this.treeProps.length&&(a="PROP_"+this.treeProps[s].ID,r=this.GetRowValues(c,a));s++){if(n=[],this.showAbsent)for(o=[],l=[],l=BX.clone(c,!0),e=0;e<r.length;e++)l[a]=r[e],n[n.length]=r[e],this.GetCanBuy(l)&&(o[o.length]=r[e]);else o=r;this.selectedValues[a]&&BX.util.in_array(this.selectedValues[a],o)?c[a]=this.selectedValues[a]:this.showAbsent?c[a]=o.length?o[0]:n[0]:c[a]=o[0],this.UpdateRow(s,c[a],r,o)}this.selectedValues=c,this.ChangeInfo()}},t.JCCatalogElement.prototype.RowLeft=function(){var t,i="",s=-1,e=BX.proxy_context;if(e&&e.hasAttribute("data-treevalue")){for(i=e.getAttribute("data-treevalue"),t=0;t<this.treeProps.length;t++)if(this.treeProps[t].ID===i){s=t;break}-1<s&&this.treeRowShowSize<this.showCount[s]&&0>this.showStart[s]&&(this.showStart[s]++,BX.adjust(this.obTreeRows[s].LIST,{style:{marginLeft:20*this.showStart[s]+"%"}}))}},t.JCCatalogElement.prototype.RowRight=function(){var t,i="",s=-1,e=BX.proxy_context;if(e&&e.hasAttribute("data-treevalue")){for(i=e.getAttribute("data-treevalue"),t=0;t<this.treeProps.length;t++)if(this.treeProps[t].ID===i){s=t;break}-1<s&&this.treeRowShowSize<this.showCount[s]&&this.treeRowShowSize-this.showStart[s]<this.showCount[s]&&(this.showStart[s]--,BX.adjust(this.obTreeRows[s].LIST,{style:{marginLeft:20*this.showStart[s]+"%"}}))}},t.JCCatalogElement.prototype.UpdateRow=function(t,i,s,e){var a=0,r=0,o="",n=0,h={},c=null,l=!1;this.treeEnableArrow,this.treeEnableArrow;if(-1<t&&t<this.obTreeRows.length&&(propMode=this.treeProps[t].DISPLAY_TYPE,(c=BX.findChildren(this.obTreeRows[t].LIST,{tagName:this.skuVisualParams[propMode].TAG},!1))&&0<c.length)){for(selectMode="SELECT"===this.treeProps[t].DISPLAY_TYPE,n=s.length,h={style:{},props:{disabled:"",selected:""}},a=0;a<c.length;a++)l=(o=c[a].getAttribute("data-onevalue"))===i,BX.util.in_array(o,e)?h.props.className=l?this.skuVisualParams[propMode].ACTIVE_CLASS:"":h.props.className=l?this.skuVisualParams[propMode].ACTIVE_CLASS+" "+this.skuVisualParams[propMode].HIDE_CLASS:this.skuVisualParams[propMode].HIDE_CLASS,selectMode?(h.props.disabled="disabled",h.props.selected=l?"selected":""):h.style.display="none",BX.util.in_array(o,s)&&(selectMode?h.props.disabled="":h.style.display="",l&&r,r++),BX.adjust(c[a],h);selectMode&&$(this.obTreeRows[t].LIST).parent().hasClass("ik_select")&&$(this.obTreeRows[t].LIST).ikSelect("reset"),this.showCount[t]=n,this.showStart[t]=0}},t.JCCatalogElement.prototype.GetRowValues=function(t,i){var s=[],e=0,a=0,r=!1,o=!0;if(0===t.length){for(e=0;e<this.offers.length;e++)BX.util.in_array(this.offers[e].TREE[i],s)||(s[s.length]=this.offers[e].TREE[i]);r=!0}else for(e=0;e<this.offers.length;e++){o=!0;for(a in t)if(t[a]!==this.offers[e].TREE[a]){o=!1;break}o&&(BX.util.in_array(this.offers[e].TREE[i],s)||(s[s.length]=this.offers[e].TREE[i]),r=!0)}return!!r&&s},t.JCCatalogElement.prototype.GetCanBuy=function(t){var i=0,s=0,e=!0,a=!1;for(i=0;i<this.offers.length;i++){e=!0;for(s in t)if(t[s]!==this.offers[i].TREE[s]){e=!1;break}if(e&&this.offers[i].CAN_BUY){a=!0;break}}return a},t.JCCatalogElement.prototype.SetCurrent=function(){var t=0,i=0,s="",e=!1,a=[],r={},o=[],n=this.offers[this.offerNum].TREE;for(t=0;t<this.treeProps.length&&(s="PROP_"+this.treeProps[t].ID,e=this.GetRowValues(r,s));t++){if(BX.util.in_array(n[s],e)?r[s]=n[s]:(r[s]=e[0],this.offerNum=0),this.config.showAbsent)for(a=[],o=[],o=BX.clone(r,!0),i=0;i<e.length;i++)o[s]=e[i],this.GetCanBuy(o)&&(a[a.length]=e[i]);else a=e;this.UpdateRow(t,r[s],e,a)}this.selectedValues=r,this.ChangeInfo()},t.JCCatalogElement.prototype.ChangeInfo=function(){var i=-1,s=0,e=0,a=!0;for(s=0;s<this.offers.length;s++){a=!0;for(e in this.selectedValues)if(this.selectedValues[e]!==this.offers[s].TREE[e]){a=!1;break}if(a){i=s;break}}if(-1<i){for(setViewedProduct(this.offers[i].ID,{PRODUCT_ID:this.offers[i].PRODUCT_ID,IBLOCK_ID:this.offers[i].IBLOCK_ID,NAME:this.product.name,DETAIL_PAGE_URL:this.offers[i].URL,PICTURE_ID:this.offers[i].PREVIEW_PICTURE?this.offers[i].PREVIEW_PICTURE.ID:this.offers[i].PARENT_PICTURE?this.offers[i].PARENT_PICTURE.ID:!!this.offers[i].SLIDER_COUNT&&this.offers[i].SLIDER[0].ID,CATALOG_MEASURE_NAME:this.offers[i].MEASURE,MIN_PRICE:this.offers[i].PRICE,CAN_BUY:this.offers[i].CAN_BUY?"Y":"N",IS_OFFER:"Y",WITH_OFFERS:"N"}),s=0;s<this.offers.length;s++)this.config.showOfferGroup&&this.offers[s].OFFER_GROUP&&s!==i&&BX.adjust(BX(this.visual.OFFER_GROUP+this.offers[s].ID),{style:{display:"none"}});if(this.config.showOfferGroup&&this.offers[i].OFFER_GROUP&&BX.adjust(BX(this.visual.OFFER_GROUP+this.offers[i].ID),{style:{display:""}}),0<this.offers[i].SLIDER_COUNT?this.SetMainPict(this.offers[i].ID,this.offers[i].SLIDER[0].ID):this.SetMainPictFromItem(i),this.SetSliderPict(this.offers[i],this.offers[i].SLIDER),this.SetSliderPictMobile(this.offers[i],this.offers[i].SLIDER),this.config.showSkuProps&&this.obSkuProps){var r="",o=this.offers[i].TYPE_PROP;if(this.offers[i].DISPLAY_PROPERTIES&&0!==this.offers[i].DISPLAY_PROPERTIES.length){"TABLE"!=o&&$(this.obSkuProps).find(".sku_block_prop").remove();for(var s in this.offers[i].DISPLAY_PROPERTIES){var n=this.offers[i].DISPLAY_PROPERTIES[s].HINT&&"Y"==this.offers[i].DISPLAY_PROPERTIES[s].SHOW_HINTS?" whint":"",h=this.offers[i].DISPLAY_PROPERTIES[s].HINT&&"Y"==this.offers[i].DISPLAY_PROPERTIES[s].SHOW_HINTS?'<div class="hint"><span class="icon"><i>?</i></span><div class="tooltip">'+this.offers[i].DISPLAY_PROPERTIES[s].HINT+"</div></div>":"";"TABLE"==o?r+='<tr><td class="char_name"><span class="'+n+'">'+h+this.offers[i].DISPLAY_PROPERTIES[s].NAME+'</span></td><td class="char_value"><span>'+this.offers[i].DISPLAY_PROPERTIES[s].VALUE+"</span></td></tr>":(r='<div class="char sku_block_prop"><div class="char_name"><span class="'+n+'">'+h+this.offers[i].DISPLAY_PROPERTIES[s].NAME+'</span></div><div class="char_value"><span>'+this.offers[i].DISPLAY_PROPERTIES[s].VALUE+"</span></div></div>",$(this.obSkuProps).append(r))}"TABLE"==o&&BX.adjust(this.obSkuProps,{style:{display:""},html:r})}else"TABLE"==o?BX.adjust(this.obSkuProps,{style:{display:"none"},html:""}):$(this.obSkuProps).find(".sku_block_prop").remove()}this.config.showSkuProps&&this.obSkuArticleProps&&("DISPLAY_PROPERTIES_CODE"in this.offers[i]&&"ARTICLE"in this.offers[i].DISPLAY_PROPERTIES_CODE?this.offers[i].DISPLAY_PROPERTIES_CODE.ARTICLE.VALUE&&BX.adjust(this.obSkuArticleProps,{style:{display:""},html:this.offers[i].DISPLAY_PROPERTIES_CODE.ARTICLE.VALUE_FORMAT}):"Y"==this.offers[i].SHOW_ARTICLE_SKU&&this.offers[i].ARTICLE_SKU?BX.adjust(this.obSkuArticleProps,{style:{display:""},html:this.offers[i].ARTICLE_SKU}):BX.adjust(this.obSkuArticleProps,{style:{display:"none"},html:""})),setLocationSKU(this.offers[i].ID),$(this.obBasketActions).closest(".counter_wrapp").addClass("hidden_block"),this.offerNum=i,this.QuantitySet(this.offerNum),this.setStoreBlock(this.offers[i].ID),this.setQuantityStore(this.offers[i].MAX_QUANTITY,this.offers[i].AVAILIABLE.TEXT),this.incViewedCounter(),BX.onCustomEvent("onCatalogStoreProductChange",[this.offers[this.offerNum].ID]),$(this.obPict).parent().data("id",this.offers[i].ID);var c=this.offers[i].PRICE;"Q"==this.offers[i].ITEM_PRICE_MODE&&this.offers[i].ITEM_PRICES&&this.offers[i].USE_PRICE_COUNT&&(this.offers[i].USE_PRICE_COUNT&&this.offers[i].PRICE_MATRIX&&this.checkPriceRange(this.offers[i].CONFIG.MIN_QUANTITY_BUY),(c=this.currentPrices[this.currentPriceSelected]).VALUE=c.PRICE,c.PRINT_VALUE=getCurrentPrice(c.PRICE,c.CURRENCY,c.PRINT_PRICE),c.DISCOUNT_VALUE=c.BASE_PRICE,c.PRINT_DISCOUNT_VALUE=getCurrentPrice(c.BASE_PRICE,c.CURRENCY,c.PRINT_BASE_PRICE));var l=this.offers[i],u=$(this.obProduct),f=this;"undefined"!=typeof arBasketAspro?this.setActualDataBlock(u,l):void 0!==t.frameCacheVars&&BX.addCustomEvent("onFrameDataReceived",function(){f.setActualDataBlock(u,l)}),$(this.obProduct).find(".quantity_block .values").length&&$(this.obProduct).find(".quantity_block .values .item span.value").text(this.offers[i].MAX_QUANTITY).css({opacity:"1"}),"Y"==this.offers[i].SHOW_DISCOUNT_TIME_EACH_SKU&&initCountdownTime($(this.obProduct),this.offers[i].DISCOUNT_ACTIVE),"Y"==arMShopOptions.THEME.CHANGE_TITLE_ITEM&&(document.title=this.offers[i].NAME,$("h1").text(this.offers[i].NAME),ItemObj.TITLE=this.offers[i].NAME,ItemObj.WINDOW_TITLE=this.offers[i].NAME+""+this.offers[i].POSTFIX),$('.catalog_detail .tabs_section .tabs_content .form.inline input[data-sid="PRODUCT_NAME"]').attr("value",$("h1").text())}},t.JCCatalogElement.prototype.checkPriceRange=function(t){if(void 0!==t&&"Q"==this.currentPriceMode){var i,s=!1;for(var e in this.currentQuantityRanges)if(this.currentQuantityRanges.hasOwnProperty(e)&&(i=this.currentQuantityRanges[e],parseInt(t)>=parseInt(i.SORT_FROM)&&("INF"==i.SORT_TO||parseInt(t)<=parseInt(i.SORT_TO)))){s=!0,this.currentQuantityRangeSelected=i.HASH;break}!s&&(i=this.getMinPriceRange())&&(this.currentQuantityRangeSelected=i.HASH);for(var a in this.currentPrices)if(this.currentPrices.hasOwnProperty(a)&&this.currentPrices[a].QUANTITY_HASH==this.currentQuantityRangeSelected){this.currentPriceSelected=a;break}}},t.JCCatalogElement.prototype.getMinPriceRange=function(){var t;for(var i in this.currentQuantityRanges)this.currentQuantityRanges.hasOwnProperty(i)&&(!t||parseInt(this.currentQuantityRanges[i].SORT_FROM)<parseInt(t.SORT_FROM))&&(t=this.currentQuantityRanges[i]);return t},t.JCCatalogElement.prototype.setActualDataBlock=function(t,i){this.setLikeBlock(t,".like_icons .wish_item",i,"DELAY"),this.setLikeBlock(t,".like_icons .compare_item",i,"COMPARE"),this.setBuyBlock(t,i)},t.JCCatalogElement.prototype.SetSliderPict=function(t,i){var s=$(".wrapp_thumbs"),e="";countPhoto=t.SLIDER_COUNT,s.find(".thumbs").css({"max-width":Math.ceil(70*(countPhoto<=4?countPhoto:4)-10)}),e='<ul class="slides_block">';for(var a in i)"object"==typeof i[a]&&(e+='<li data-big="'+i[a].BIG.src+'"><span class="cnt"><img border="0" src="'+i[a].THUMB.src+'" alt="'+i[a].ALT+'" title="'+i[a].TITLE+'" /></span></li>');if(e+="</ul>",s.find(".thumbs").html(e),countPhoto>1){s.show(),s.find(".thumbs_navigation").length&&s.find(".thumbs_navigation").remove(),s.append('<span class="thumbs_navigation"></span>'),s.find(".thumbs").removeData("flexslider"),s.find(".thumbs").flexslider({animation:"slide",selector:".slides_block > li",slideshow:!1,animationSpeed:600,directionNav:!0,controlNav:!1,pauseOnHover:!0,itemWidth:60,itemMargin:10,animationLoop:!0,controlsContainer:".thumbs_navigation"}),s.find(".thumbs li").first().addClass("current");var r=$(this.obPict);s.find(".thumbs").delegate("li:not(.current)","click",function(t){var s="",e="";index=$(this).index(),"SMALL"in i[index]?s=i[index].SMALL.src:"SRC"in i[index]&&(s=i[index].SRC),"BIG"in i[index]&&(e=i[index].BIG.src),"WIDTH"in i[index]&&i[index].WIDTH,"HEIGHT"in i[index]&&i[index].HEIGHT,$(this).addClass("current").siblings().removeClass("current").parents(".item_slider").find(".slides li").fadeOut(333),$(this).parents(".item_slider").find(".slides li").eq(index).addClass("current").stop().fadeIn(333),s&&BX.adjust(r[0],{props:{src:s}}),e&&(r.parent().attr("href",e),r.parent().attr("title",i[index].TITLE),r.parent().attr("alt",i[index].ALT),r.attr("title",i[index].TITLE),r.attr("alt",i[index].ALT))})}else s.hide()},t.JCCatalogElement.prototype.SetSliderPictMobile=function(t,i){var s=$(".item_slider.flex"),e="";if(countPhoto=t.SLIDER_COUNT,e='<ul class="slides">',i.length)for(var a in i)"object"==typeof i[a]&&(e+='<li data-value="'+t.ID+"_"+i[a].ID+'"><a href="'+i[a].BIG.src+'" data-fancybox-group="item_slider" class="fancy" title="'+i[a].TITLE+'"><img border="0" src="'+i[a].SMALL.src+'" alt="'+i[a].ALT+'" title="'+i[a].TITLE+'" /></a></li>');else e+='<li data-value=""><span data-fancybox-group="item_slider" class="fancy" title="'+t.NAME+'"><img border="0" src="'+t.NO_PHOTO.SRC+'" alt="'+t.NAME+'" title="'+t.NAME+'" /></span></li>';e+="</ul>",s.html(e),s.removeData("flexslider"),s.flexslider({animation:"slide",slideshow:!0,slideshowSpeed:1e4,animationSpeed:600,directionNav:!1,pauseOnHover:!0,animationLoop:!1})},t.JCCatalogElement.prototype.setLikeBlock=function(t,i,s,e){var a=t;"DELAY"==e&&(s.CAN_BUY?a.find(i).css("display","inline-block"):a.find(i).hide()),a.find(i).attr("data-item",s.ID),arBasketAspro[e]&&(a.find(i).removeClass("added"),a.find(i).find(".value").css("display","block"),a.find(i).find(".value.added").hide(),void 0!==arBasketAspro[e][s.ID]&&(a.find(i).addClass("added"),a.find(i).find(".value").hide(),a.find(i).find(".value.added").css("display","block")))},t.JCCatalogElement.prototype.setBuyBlock=function(t,i){var s=t.find(".offer_buy_block"),e=i.CONFIG.MIN_QUANTITY_BUY;if(s.find(".counter_wrapp .counter_block").length&&s.find(".counter_wrapp .counter_block").attr("data-item",i.ID),i.offer_set_quantity&&(e=i.offer_set_quantity),i.CONFIG.OPTIONS.USE_PRODUCT_QUANTITY_DETAIL&&"ADD"==i.CONFIG.ACTION&&i.CAN_BUY){var a=i.CONFIG.MAX_QUANTITY_BUY>0?"data-max='"+i.CONFIG.MAX_QUANTITY_BUY+"'":"",r='<span class="minus">-</span><input type="text" class="text" name="'+i.PRODUCT_QUANTITY_VARIABLE+'" value="'+e+'" /><span class="plus" '+a+">+</span>";arBasketAspro.BASKET&&void 0!==arBasketAspro.BASKET[i.ID]?s.find(".counter_wrapp .counter_block").length?s.find(".counter_wrapp .counter_block").hide():(s.find(".counter_wrapp").prepend('<div class="counter_block big_basket" data-item="'+i.ID+'"></div>'),s.find(".counter_wrapp .counter_block").html(r).hide()):s.find(".counter_wrapp .counter_block").length?s.find(".counter_wrapp .counter_block").html(r).show():(s.find(".counter_wrapp").prepend('<div class="counter_block big_basket" data-item="'+i.ID+'"></div>'),s.find(".counter_wrapp .counter_block").html(r))}else s.find(".counter_wrapp .counter_block").length&&s.find(".counter_wrapp .counter_block").hide();var o="ORDER"==i.CONFIG.ACTION||!i.CAN_BUY||!i.CONFIG.OPTIONS.USE_PRODUCT_QUANTITY_DETAIL||"SUBSCRIBE"==i.CONFIG.ACTION&&"Y"==i.CATALOG_SUBSCRIBE?"wide":"";$('<div class="button_block"></div>');if(s.find(".counter_wrapp").find(".button_block").length?arBasketAspro.BASKET&&void 0!==arBasketAspro.BASKET[i.ID]?(s.find(".counter_wrapp").find(".button_block").addClass("wide").html(i.HTML),markProductAddBasket(i.ID)):o?(s.find(".counter_wrapp").find(".button_block").addClass("wide").html(i.HTML),"undefined"!=typeof arBasketAspro&&arBasketAspro.SUBSCRIBE&&void 0!==arBasketAspro.SUBSCRIBE[i.ID]&&markProductSubscribe(i.ID)):s.find(".counter_wrapp").find(".button_block").removeClass("wide").html(i.HTML):(s.find(".counter_wrapp").append('<div class="button_block '+o+'">'+i.HTML+"</div>"),arBasketAspro.BASKET&&void 0!==arBasketAspro.BASKET[i.ID]&&markProductAddBasket(i.ID),arBasketAspro.SUBSCRIBE&&void 0!==arBasketAspro.SUBSCRIBE[i.ID]&&markProductSubscribe(i.ID)),"NOTHING"!==i.CONFIG.ACTION)if("ADD"==i.CONFIG.ACTION&&i.CAN_BUY&&"N"!=i.SHOW_ONE_CLICK_BUY){var n='<span class="transparent big_btn type_block button one_click" data-offers="Y" data-item="'+i.ID+'" data-iblockID="'+i.IBLOCK_ID+'" data-quantity="'+i.CONFIG.MIN_QUANTITY_BUY+'" data-props="'+i.OFFER_PROPS+'" onclick="oneClickBuy('+i.ID+", "+i.IBLOCK_ID+', this)"><span>'+i.ONE_CLICK_BUY+"</span></span>";s.find(".wrapp_one_click").length?s.find(".wrapp_one_click").html(n):s.append('<div class="wrapp_one_click">'+n+"</div>")}else s.find(".wrapp_one_click").length&&s.find(".wrapp_one_click").remove();else s.find(".wrapp_one_click").length&&s.find(".wrapp_one_click").remove();s.fadeIn(),s.find(".counter_wrapp .counter_block input").data("product","ob"+t[0].id),this.setPriceAction("","Y")},t.JCCatalogElement.prototype.setStoreBlock=function(t){$(".stores_tab > div").hide(),$(".stores_tab .sku_stores_"+t).show()},t.JCCatalogElement.prototype.setQuantityStore=function(t,i){parseFloat(t)>0?$(this.storeQuanity).find(".icon").removeClass("order").addClass("stock"):$(this.storeQuanity).find(".icon").removeClass("stock").addClass("order"),$(this.storeQuanity).find(".icon + span").html(i),$(".stores_tab").length||$(".item-stock .store_view").removeClass("store_view")},t.JCCatalogElement.prototype.CompareCountResult=function(t){if(t.COMPARE_COUNT){for(var i in t.ITEMS){if(t.ITEMS[i]==this.offers[this.offerNum].ID){this.offers[this.offerNum].COMPARE_ACTIVE=!0;break}this.offers[this.offerNum].COMPARE_ACTIVE=!1}this.offers[this.offerNum].COMPARE_ACTIVE?($(this.obCompare).addClass("added"),$(this.obCompare).find(".value:not(.added)").hide(),$(this.obCompare).find(".value.added").css("display","inline-block")):($(this.obCompare).removeClass("added"),$(this.obCompare).find(".value.added").hide(),$(this.obCompare).find(".value:not(.added)").css("display","inline-block"))}},t.JCCatalogElement.prototype.ItemInfoResult=function(t){t.HTML&&($(this.obBasketActions).html(t.HTML),$(this.obBasketActions).show(),this.obAddToBasketBtn=BX(this.visual.BUY_ID),this.obBasketBtn=BX(this.visual.BASKET_LINK),this.obSubscribeBtn=BX(this.visual.SUBSCRIBE_ID),this.obSubscribedBtn=BX(this.visual.SUBSCRIBED_ID),BX.bind(this.obAddToBasketBtn,"click",BX.delegate(this.Add2Basket,this)),$(this.obBasketActions).removeClass("wide"),this.ajax_type_item=t.BUYMISSINGGOODS,"ADD"==t.BUYMISSINGGOODS||this.canBuy?$(this.obQuantity).css("display",""):$(this.obBasketActions).addClass("wide"),t.ONE_CLICK_HTML&&$(".wrapp_one_click").html(t.ONE_CLICK_HTML)),basketParams={ajax_action:"Y"},BX.ajax.loadJSON(arMShopOptions.SITE_DIR+"ajax/get_basket_count.php",basketParams,BX.delegate(this.BasketCountResult,this))},t.JCCatalogElement.prototype.BasketCountResult=function(t){for(var i in t.ITEMS){if(t.ITEMS[i].PRODUCT_ID==this.offers[this.offerNum].ID){this.offers[this.offerNum].BASKET_ACTIVE=!0;break}this.offers[this.offerNum].BASKET_ACTIVE=!1}for(var i in t.SUBSCRIBE_ITEMS){if(t.SUBSCRIBE_ITEMS[i].PRODUCT_ID==this.offers[this.offerNum].ID){this.offers[this.offerNum].SUBSCRIBE_ACTIVE=!0;break}this.offers[this.offerNum].SUBSCRIBE_ACTIVE=!1}this.BasketStateRefresh()},t.JCCatalogElement.prototype.BasketStateRefresh=function(i){this.offers[this.offerNum].SUBSCRIBE_ACTIVE?($(this.obBasketActions).addClass("wide"),$(this.obSubscribeBtn).hide(),$(this.obSubscribedBtn).show()):($(this.obBasketActions).addClass("wide"),$(this.obSubscribedBtn).hide(),$(this.obSubscribeBtn).show()),this.offers[this.offerNum].BASKET_ACTIVE?($(this.obAddToBasketBtn).hide(),$(this.obQuantity).closest(".counter_wrapp").find(".counter_block").hide(),$(this.obBasketBtn).show(),$(this.obBasketActions).addClass("wide")):($(this.obBasketActions).removeClass("wide"),$(this.obBasketBtn).hide(),("ADD"==this.ajax_type_item||this.canBuy)&&$(this.obQuantity).closest(".counter_wrapp").find(".counter_block").show(),$(this.obAddToBasketBtn).show()),this.canBuy||$(this.obBasketActions).addClass("wide"),this.canBuy&&$(".one_click").removeClass("hidden_block").css("opacity",1),BX.style(this.obBasketActions,"opacity","1"),$(this.obBasketActions).closest(".counter_wrapp").removeClass("hidden_block").css("opacity",1),"undefined"!==i&&"Y"==i&&($("#basket_line .basket_fly").length&&$(t).outerWidth()>768?basketFly("open"):$("#basket_line .cart").length&&($("#basket_line .cart").is(".empty_cart")&&($("#basket_line .cart").removeClass("empty_cart").find(".cart_wrapp a.basket_link").removeAttr("href").addClass("cart-call"),touchBasket(".cart:not(.empty_cart) .basket_block .link")),reloadTopBasket("add",$("#basket_line"),200,2e3,"Y")),animateBasketLine(200))},t.JCCatalogElement.prototype.setPriceAction=function(t,i){var s=this.offers[this.offerNum].MEASURE&&"Y"==this.offers[this.offerNum].SHOW_MEASURE?this.offers[this.offerNum].MEASURE:"",e=$(this.obProduct),a="",r=void 0!==i&&"Y"==i;if(this.offers[this.offerNum].offer_set_quantity=this.offers[this.offerNum].CONFIG.MIN_QUANTITY_BUY,$(e).find("input[name=quantity]").length&&(this.offers[this.offerNum].offer_set_quantity=$(e).find("input[name=quantity]").val()),this.offers[this.offerNum].USE_PRICE_COUNT&&this.offers[this.offerNum].PRICE_MATRIX?(this.checkPriceRange(this.offers[this.offerNum].offer_set_quantity),this.setPriceMatrix(this.offers[this.offerNum].PRICE_MATRIX)):"PRICES"in this.offers[this.offerNum]&&this.setPrice(this.offers[this.offerNum].PRICES,s),"Y"==arMShopOptions.THEME.SHOW_TOTAL_SUMM){if(this.offers[this.offerNum].check_quantity)a="Y";else(a=void 0!==t&&"Y"==t?t:"")&&(this.offers[this.offerNum].check_quantity=!0);void 0!==this.currentPrices[this.currentPriceSelected]&&setPriceItem(e,this.offers[this.offerNum].offer_set_quantity,this.currentPrices[this.currentPriceSelected].PRICE,a,r)}},t.JCCatalogElement.prototype.setPriceMatrix=function(t){if(this.obPrice.price){var i=this.offers[this.offerNum].MEASURE&&"Y"==this.offers[this.offerNum].SHOW_MEASURE?this.offers[this.offerNum].MEASURE:"",s="";s=getCurrentPrice(this.currentPrices[this.currentPriceSelected].PRICE,this.currentPrices[this.currentPriceSelected].CURRENCY,this.currentPrices[this.currentPriceSelected].PRINT_PRICE),i&&(s+='<span class="price_measure">/'+i+"</span>"),$(this.obProduct).find(".not_matrix").hide(),$(this.obProduct).find(".with_matrix .price_value_block").html(s),this.config.showOldPrice?($(this.obProduct).find(".price.discount").hide(),parseFloat(this.currentPrices[this.currentPriceSelected].BASE_PRICE)>parseFloat(this.currentPrices[this.currentPriceSelected].PRICE)?($(this.obProduct).find(".with_matrix .discount").html(getCurrentPrice(this.currentPrices[this.currentPriceSelected].BASE_PRICE,this.currentPrices[this.currentPriceSelected].CURRENCY,this.currentPrices[this.currentPriceSelected].PRINT_BASE_PRICE)),$(this.obProduct).find(".with_matrix .discount").css("display","inline-block")):($(this.obProduct).find(".with_matrix .discount").html(""),$(this.obProduct).find(".with_matrix .discount").css("display","none"))):($(this.obProduct).find(".with_matrix .discount").html(""),$(this.obProduct).find(".with_matrix .discount").css("display","none")),$(this.obProduct).find(".sale_block.normal").hide(),$(this.obProduct).find(".sale_block:not(.matrix)").hide(),this.currentPrices[this.currentPriceSelected].PERCENT>0?($(this.obProduct).find(".with_matrix .sale_block .text .values_wrapper").html(getCurrentPrice(this.currentPrices[this.currentPriceSelected].DISCOUNT,this.currentPrices[this.currentPriceSelected].CURRENCY,this.currentPrices[this.currentPriceSelected].PRINT_DISCOUNT)),$(this.obProduct).find(".with_matrix .sale_block .value span").html(this.currentPrices[this.currentPriceSelected].PERCENT),$(this.obProduct).find(".with_matrix .sale_block").show()):$(this.obProduct).find(".with_matrix .sale_block").hide(),$(this.obProduct).find(".with_matrix").show(),BX.adjust(this.obPrice.price,{html:t});var e={product:$(this.obProduct),measure:i,config:this.config,offer:this.offers[this.offerNum],obPrice:this.currentPrices[this.currentPriceSelected]};BX.onCustomEvent("onAsproSkuSetPriceMatrix",[e])}},t.JCCatalogElement.prototype.setPrice=function(t,i,s,e,a,r){if(this.obPrice.price){e=this.offers[this.offerNum].MEASURE&&"Y"==this.offers[this.offerNum].SHOW_MEASURE?this.offers[this.offerNum].MEASURE:"",a=$(this.obProduct),s=this.offers[this.offerNum].PRICES;if("object"==typeof s){var o="",n=Object.keys(s).length;o='<div class="offers_price_wrapper">',$(this.obProduct).find(".with_matrix").hide(),$(this.obProduct).find(".not_matrix").show(),this.offers[this.offerNum].offer_set_quantity=this.offers[this.offerNum].CONFIG.MIN_QUANTITY_BUY,$(a).find("input[name=quantity]").length&&(this.offers[this.offerNum].offer_set_quantity=$(a).find("input[name=quantity]").val()),this.config.showOldPrice&&$(this.obProduct).find(".price.discount").hide(),this.config.showPercent&&(this.obPrice.percent&&BX.adjust(this.obPrice.percent,{style:{display:"none"},html:""}),$(this.obPrice.price).closest(".cost").find(".sale_block:not(.matrix)").hide(),$(this.obPrice.price).closest(".cost").find(".sale_block:not(.matrix) .value").html(""),$(this.obPrice.price).closest(".cost").find(".sale_block:not(.matrix) .text span").html(""));for(var h in s)s[h]&&("GROUP_NAME"in s[h]&&n>1&&(o+='<div class="offers_price_title">',o+=s[h].GROUP_NAME,o+="</div>"),o+='<div class="offers_price">',o+='<span class="values_wrapper">'+getCurrentPrice(s[h].DISCOUNT_VALUE,s[h].CURRENCY,s[h].PRINT_DISCOUNT_VALUE)+"</span>",e&&(o+='<span class="price_measure">/'+e+"</span>"),o+="</div>",s[h].DISCOUNT_VALUE!==s[h].VALUE?(this.config.showOldPrice&&(o+='<div class="offers_price_old">',o+='<span class="values_wrapper">'+getCurrentPrice(s[h].VALUE,s[h].CURRENCY,s[h].PRINT_VALUE)+"</span>",o+="</div>"),this.config.showPercent&&(o+='<div class="sale_block">',o+='<div class="value">-',o+="<span>"+s[h].DISCOUNT_DIFF_PERCENT+"</span>",o+="%</div>",o+='<div class="text">',o+='<span class="title">'+BX.message("ITEM_ECONOMY")+"</span>",o+='<span class="values_wrapper">'+getCurrentPrice(s[h].DISCOUNT_DIFF,s[h].CURRENCY,s[h].PRINT_DISCOUNT_DIFF)+"</span>",o+="</div>",o+='<div class="clearfix"></div></div>')):this.config.showOldPrice&&(this.obPrice.full&&BX.adjust(this.obPrice.full,{style:{display:"none"},html:""}),this.obPrice.discount&&BX.adjust(this.obPrice.discount,{style:{display:"none"},html:""})));o+="</div>",BX.adjust(this.obPrice.price,{html:o}),this.obPrice.full&&($(this.obPrice.full).hide().html(""),this.showPercent&&$(this.obPrice.full).closest(".cost").find(".sale_block").hide());var c={product:a,measure:e,config:this.config,offer:this.offers[this.offerNum],obPrices:s};BX.onCustomEvent("onAsproSkuSetPrice",[c])}}},t.JCCatalogElement.prototype.Compare=function(){var t,i;if($(this.obCompare).find(".added").is(":visible")?(i=this.compareData.compareUrlDel,this.compareData.Added=!1):(i=this.compareData.compareUrl,this.compareData.Added=!0),i){switch(this.productType){case 1:case 2:i=i.replace("#ID#",this.product.id.toString());break;case 3:i=i.replace("#ID#",this.offers[this.offerNum].ID)}t={ajax_action:"Y"},BX.ajax.loadJSON(i,t,BX.proxy(this.CompareResult,this))}},t.JCCatalogElement.prototype.CompareResult=function(t){return"object"==typeof t&&("OK"===t.STATUS?(BX.onCustomEvent("OnCompareChange"),this.compareData.Added?($(this.obCompare).addClass("added"),$(this.obCompare).find(".value:not(.added)").hide(),$(this.obCompare).find(".added").css("display","inline-block")):($(this.obCompare).removeClass("added"),$(this.obCompare).find(".added").hide(),$(this.obCompare).find(".value:not(.added)").css("display","inline-block")),jsAjaxUtil.InsertDataToNode(arMShopOptions.SITE_DIR+"ajax/show_compare_preview_top.php","compare_line",!1)):console.log(BX.message("ADD_ERROR_COMPARE")),!1)},t.JCCatalogElement.prototype.CompareRedirect=function(){this.compareData.comparePath?location.href=this.compareData.comparePath:this.obPopupWin.close()},t.JCCatalogElement.prototype.InitBasketUrl=function(){var t="";switch(this.basketUrl="ADD"===this.basketMode?this.basketData.add_url:this.basketData.buy_url,this.productType){case 1:case 2:this.basketUrl=this.basketUrl.replace("#ID#",this.product.id.toString()),t=this.product.id.toString();break;case 3:this.basketUrl=this.basketUrl.replace("#ID#",this.offers[this.offerNum].ID),t=this.offers[this.offerNum].URL}this.basketParams={ajax_basket:"Y"},this.config.showQuantity&&(this.basketParams[this.basketData.quantity]=this.obQuantity.value),this.basketData.sku_props&&(this.basketParams[this.basketData.sku_props_var]=this.basketData.sku_props),t&&(this.basketParams.REQUEST_URI=t)},t.JCCatalogElement.prototype.FillBasketProps=function(){if(this.visual.BASKET_PROP_DIV){var t=0,i=null,s=!1,e=null;if(this.basketData.useProps&&!this.basketData.emptyProps?this.obPopupWin&&this.obPopupWin.contentContainer&&(e=this.obPopupWin.contentContainer):e=BX(this.visual.BASKET_PROP_DIV),e){if((i=e.getElementsByTagName("select"))&&i.length)for(t=0;t<i.length;t++)if(!i[t].disabled)switch(i[t].type.toLowerCase()){case"select-one":this.basketParams[i[t].name]=i[t].value,s=!0}if((i=e.getElementsByTagName("input"))&&i.length)for(t=0;t<i.length;t++)if(!i[t].disabled)switch(i[t].type.toLowerCase()){case"hidden":this.basketParams[i[t].name]=i[t].value,s=!0;break;case"radio":i[t].checked&&(this.basketParams[i[t].name]=i[t].value,s=!0)}}s||(this.basketParams[this.basketData.props]=[],this.basketParams[this.basketData.props][0]=0)}},t.JCCatalogElement.prototype.SendToBasket=function(){this.canBuy&&(this.InitBasketUrl(),this.FillBasketProps(),BX.ajax.loadJSON(this.basketUrl,this.basketParams,BX.proxy(this.BasketResult,this)))},t.JCCatalogElement.prototype.Add2Basket=function(){this.basketMode="ADD",this.Basket()},t.JCCatalogElement.prototype.BuyBasket=function(){this.basketMode="BUY",this.Basket()},t.JCCatalogElement.prototype.Basket=function(){this.canBuy&&this.SendToBasket()},t.JCCatalogElement.prototype.BasketResult=function(t){return this.obPopupWin&&this.obPopupWin.close(),"object"==typeof t&&("OK"===t.STATUS&&"BUY"===this.basketMode?this.BasketRedirect():({content:BX.create("div",{style:{marginRight:"30px",whiteSpace:"nowrap"},text:"OK"===t.STATUS?BX.message("TITLE_SUCCESSFUL"):BX.message("TITLE_ERROR")})},"OK"===t.STATUS?(BX.onCustomEvent("OnBasketChange"),this.offers[this.offerNum].BASKET_ACTIVE=!0,this.BasketStateRefresh("Y")):console.log(BX.message("ADD_ERROR_BASKET"))),!1)},t.JCCatalogElement.prototype.BasketRedirect=function(){location.href=this.basketData.basketUrl?this.basketData.basketUrl:BX.message("BASKET_URL")},t.JCCatalogElement.prototype.InitPopupWindow=function(){this.obPopupWin||(this.obPopupWin=BX.PopupWindowManager.create("CatalogElementBasket_"+this.visual.ID,null,{autoHide:!1,offsetLeft:0,offsetTop:0,overlay:!0,closeByEsc:!0,titleBar:!0,closeIcon:{top:"10px",right:"10px"}}))},t.JCCatalogElement.prototype.onPopupWindowShow=function(t){BX.bind(document,"click",BX.proxy(this.popupWindowClick,this))},t.JCCatalogElement.prototype.onPopupWindowClose=function(t,i){BX.unbind(document,"click",BX.proxy(this.popupWindowClick,this))},t.JCCatalogElement.prototype.popupWindowClick=function(){this.obPopupPict&&"object"==typeof this.obPopupPict&&this.obPopupPict.isShown()&&this.obPopupPict.close()},t.JCCatalogElement.prototype.incViewedCounter=function(){if(this.currentIsSet&&!this.updateViewedCount){switch(this.productType){case 1:case 2:this.viewedCounter.params.PRODUCT_ID=this.product.id,this.viewedCounter.params.PARENT_ID=this.product.id;break;case 3:this.viewedCounter.params.PARENT_ID=this.product.id,this.viewedCounter.params.PRODUCT_ID=this.offers[this.offerNum].ID;break;default:return}this.viewedCounter.params.SITE_ID=BX.message("SITE_ID"),this.updateViewedCount=!0,BX.ajax.post(this.viewedCounter.path,this.viewedCounter.params,BX.delegate(function(){this.updateViewedCount=!1},this))}},t.JCCatalogElement.prototype.allowViewedCount=function(t){t=!!t,this.currentIsSet=!0,t&&this.incViewedCounter()}}}(window);
/* End */
;
; /* Start:"a:4:{s:4:"full";s:100:"/bitrix/templates/aspro_mshop/components/bitrix/sale.gift.product/main/script.min.js?151963403729020";s:6:"source";s:80:"/bitrix/templates/aspro_mshop/components/bitrix/sale.gift.product/main/script.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
function bx_sale_gift_product_load(t,s,e){s=s||{},e=e||{},BX.ajax({url:"/bitrix/components/bitrix/sale.gift.product/ajax.php",method:"POST",data:BX.merge(s,e),dataType:"html",processData:!1,start:!0,onsuccess:function(s){var e=BX.processHTML(s);BX(t).innerHTML=e.HTML,BX.ajax.processScripts(e.SCRIPT),initCountdown()}})}!function(t){if(t.JCCatalogSectionOnlyElement||(t.JCCatalogSectionOnlyElement=function(t){"object"==typeof t&&(this.params=t,this.obProduct=null,this.set_quantity=1,this.currentPriceMode="",this.currentPrices=[],this.currentPriceSelected=0,this.currentQuantityRanges=[],this.currentQuantityRangeSelected=0,this.params.MESS&&(this.mess=this.params.MESS),this.init())},t.JCCatalogSectionOnlyElement.prototype={init:function(){this.obProduct=BX(this.params.ID),this.obProduct&&($(this.obProduct).find(".counter_wrapp .counter_block input").data("product","ob"+this.obProduct.id+"el"),this.currentPriceMode=this.params.ITEM_PRICE_MODE,this.currentPrices=this.params.ITEM_PRICES,this.currentQuantityRanges=this.params.ITEM_QUANTITY_RANGES)},setPriceAction:function(){this.set_quantity=this.params.MIN_QUANTITY_BUY,$(this.obProduct).find("input[name=quantity]").length&&(this.set_quantity=$(this.obProduct).find("input[name=quantity]").val()),this.checkPriceRange(this.set_quantity),$(this.obProduct).find(".not_matrix").hide(),$(this.obProduct).find(".with_matrix .price_value_block").html(this.currentPrices[this.currentPriceSelected].PRINT_PRICE),$(this.obProduct).find(".with_matrix .discount")&&$(this.obProduct).find(".with_matrix .discount").html(this.currentPrices[this.currentPriceSelected].PRINT_BASE_PRICE),$(this.obProduct).find(".with_matrix .sale_block .text .values_wrapper").html(this.currentPrices[this.currentPriceSelected].PRINT_DISCOUNT),$(this.obProduct).find(".with_matrix .sale_block .value span").html(this.currentPrices[this.currentPriceSelected].PERCENT),$(this.obProduct).find(".with_matrix").show(),"Y"==arMShopOptions.THEME.SHOW_TOTAL_SUMM&&setPriceItem($(this.obProduct),this.set_quantity,this.currentPrices[this.currentPriceSelected].PRICE)},checkPriceRange:function(t){if(void 0!==t&&"Q"==this.currentPriceMode){var s,e=!1;for(var i in this.currentQuantityRanges)if(this.currentQuantityRanges.hasOwnProperty(i)&&(s=this.currentQuantityRanges[i],parseInt(t)>=parseInt(s.SORT_FROM)&&("INF"==s.SORT_TO||parseInt(t)<=parseInt(s.SORT_TO)))){e=!0,this.currentQuantityRangeSelected=s.HASH;break}!e&&(s=this.getMinPriceRange())&&(this.currentQuantityRangeSelected=s.HASH);for(var o in this.currentPrices)if(this.currentPrices.hasOwnProperty(o)&&this.currentPrices[o].QUANTITY_HASH==this.currentQuantityRangeSelected){this.currentPriceSelected=o;break}}},getMinPriceRange:function(){var t;for(var s in this.currentQuantityRanges)this.currentQuantityRanges.hasOwnProperty(s)&&(!t||parseInt(this.currentQuantityRanges[s].SORT_FROM)<parseInt(t.SORT_FROM))&&(t=this.currentQuantityRanges[s]);return t}}),!t.JCSaleGiftProduct){var s=function(t){s.superclass.constructor.apply(this,arguments),this.nameNode=BX.create("span",{props:{className:"bx_medium bx_bt_button",id:this.id},text:t.text}),this.buttonNode=BX.create("span",{attrs:{className:t.ownerClass},style:{marginBottom:"0",borderBottom:"0 none transparent"},children:[this.nameNode],events:this.contextEvents}),BX.browser.IsIE()&&this.buttonNode.setAttribute("hideFocus","hidefocus")};BX.extend(s,BX.PopupWindowButton),t.JCSaleGiftProduct=function(t){if(this.skuVisualParams={SELECT:{TAG_BIND:"select",TAG:"option",ACTIVE_CLASS:"active",HIDE_CLASS:"hidden",EVENT:"change"},LI:{TAG_BIND:"li",TAG:"li",ACTIVE_CLASS:"active",HIDE_CLASS:"missing",EVENT:"click"}},this.productType=0,this.showQuantity=!0,this.showAbsent=!0,this.secondPict=!1,this.showOldPrice=!1,this.showPercent=!1,this.showSkuProps=!1,this.visual={ID:"",PICT_ID:"",SECOND_PICT_ID:"",QUANTITY_ID:"",QUANTITY_UP_ID:"",QUANTITY_DOWN_ID:"",PRICE_ID:"",DSC_PERC:"",SECOND_DSC_PERC:"",DISPLAY_PROP_DIV:"",BASKET_PROP_DIV:""},this.product={checkQuantity:!1,maxQuantity:0,stepQuantity:1,isDblQuantity:!1,canBuy:!0,canSubscription:!0,name:"",pict:{},id:0,addUrl:"",buyUrl:""},this.basketData={useProps:!1,emptyProps:!1,quantity:"quantity",props:"prop",basketUrl:""},this.defaultPict={pict:null,secondPict:null},this.checkQuantity=!1,this.maxQuantity=0,this.stepQuantity=1,this.isDblQuantity=!1,this.canBuy=!0,this.canSubscription=!0,this.precision=6,this.precisionFactor=Math.pow(10,this.precision),this.currentPriceMode="",this.currentPrices=[],this.currentPriceSelected=0,this.currentQuantityRanges=[],this.currentQuantityRangeSelected=0,this.offers=[],this.offerNum=0,this.treeProps=[],this.obTreeRows=[],this.showCount=[],this.showStart=[],this.selectedValues={},this.obProduct=null,this.obQuantity=null,this.obQuantityUp=null,this.obQuantityDown=null,this.obPict=null,this.obSecondPict=null,this.obPrice=null,this.obTree=null,this.obBuyBtn=null,this.obDscPerc=null,this.obSecondDscPerc=null,this.obSkuProps=null,this.obMeasure=null,this.obPopupWin=null,this.basketUrl="",this.basketParams={},this.treeRowShowSize=5,this.treeEnableArrow={display:"",cursor:"pointer",opacity:1},this.treeDisableArrow={display:"",cursor:"default",opacity:.2},this.lastElement=!1,this.containerHeight=0,this.errorCode=0,"object"==typeof t){switch(this.productType=parseInt(t.PRODUCT_TYPE,10),this.showQuantity=t.SHOW_QUANTITY,this.showAbsent=t.SHOW_ABSENT,this.secondPict=!!t.SECOND_PICT,this.showOldPrice=!!t.SHOW_OLD_PRICE,this.showPercent=!!t.SHOW_DISCOUNT_PERCENT,this.showSkuProps=!!t.SHOW_SKU_PROPS,this.visual=t.VISUAL,this.productType){case 1:case 2:t.PRODUCT&&"object"==typeof t.PRODUCT?(this.showQuantity&&(this.product.checkQuantity=t.PRODUCT.CHECK_QUANTITY,this.product.isDblQuantity=t.PRODUCT.QUANTITY_FLOAT,this.product.checkQuantity&&(this.product.maxQuantity=this.product.isDblQuantity?parseFloat(t.PRODUCT.MAX_QUANTITY):parseInt(t.PRODUCT.MAX_QUANTITY,10)),this.product.stepQuantity=this.product.isDblQuantity?parseFloat(t.PRODUCT.STEP_QUANTITY):parseInt(t.PRODUCT.STEP_QUANTITY,10),this.checkQuantity=this.product.checkQuantity,this.isDblQuantity=this.product.isDblQuantity,this.maxQuantity=this.product.maxQuantity,this.stepQuantity=this.product.stepQuantity,this.isDblQuantity&&(this.stepQuantity=Math.round(this.stepQuantity*this.precisionFactor)/this.precisionFactor)),this.product.canBuy=t.PRODUCT.CAN_BUY,this.product.canSubscription=t.PRODUCT.SUBSCRIPTION,this.canBuy=this.product.canBuy,this.canSubscription=this.product.canSubscription,this.product.name=t.PRODUCT.NAME,this.product.pict=t.PRODUCT.PICT,this.product.id=t.PRODUCT.ID,t.PRODUCT.ADD_URL&&(this.product.addUrl=t.PRODUCT.ADD_URL),t.PRODUCT.BUY_URL&&(this.product.buyUrl=t.PRODUCT.BUY_URL),t.BASKET&&"object"==typeof t.BASKET&&(this.basketData.useProps=!!t.BASKET.ADD_PROPS,this.basketData.emptyProps=!!t.BASKET.EMPTY_PROPS)):this.errorCode=-1;break;case 3:t.OFFERS&&BX.type.isArray(t.OFFERS)?(t.PRODUCT&&"object"==typeof t.PRODUCT&&(this.product.name=t.PRODUCT.NAME,this.product.id=t.PRODUCT.ID),this.offers=t.OFFERS,this.offerNum=0,t.OFFER_SELECTED&&(this.offerNum=parseInt(t.OFFER_SELECTED,10)),isNaN(this.offerNum)&&(this.offerNum=0),t.TREE_PROPS&&(this.treeProps=t.TREE_PROPS),t.DEFAULT_PICTURE&&(this.defaultPict.pict=t.DEFAULT_PICTURE.PICTURE,this.defaultPict.secondPict=t.DEFAULT_PICTURE.PICTURE_SECOND)):this.errorCode=-1;break;default:this.errorCode=-1}t.BASKET&&"object"==typeof t.BASKET&&(t.BASKET.QUANTITY&&(this.basketData.quantity=t.BASKET.QUANTITY),t.BASKET.PROPS&&(this.basketData.props=t.BASKET.PROPS),t.BASKET.BASKET_URL&&(this.basketData.basketUrl=t.BASKET.BASKET_URL)),this.lastElement=!!t.LAST_ELEMENT&&"Y"===t.LAST_ELEMENT}0===this.errorCode&&BX.ready(BX.delegate(this.Init,this))},t.JCSaleGiftProduct.prototype.Init=function(){var t=0,s="",e=null;if(this.obProduct=BX(this.visual.ID),this.obProduct||(this.errorCode=-1),this.obPict=BX(this.visual.PICT_ID),this.obPict||(this.errorCode=-2),this.secondPict&&this.visual.SECOND_PICT_ID&&(this.obSecondPict=BX(this.visual.SECOND_PICT_ID)),this.storeQuanity=BX(this.visual.STORE_QUANTITY),this.obPrice=BX(this.visual.PRICE_ID),this.obPriceOld=BX(this.visual.PRICE_OLD_ID),this.obPrice||(this.errorCode=-16),this.showQuantity&&this.visual.QUANTITY_ID&&(this.obQuantity=BX(this.visual.QUANTITY_ID),this.visual.QUANTITY_UP_ID&&(this.obQuantityUp=BX(this.visual.QUANTITY_UP_ID)),this.visual.QUANTITY_DOWN_ID&&(this.obQuantityDown=BX(this.visual.QUANTITY_DOWN_ID))),3===this.productType){if(this.visual.TREE_ID)for(this.obTree=BX(this.visual.TREE_ID),this.obTree||(this.errorCode=-256),s=this.visual.TREE_ITEM_ID,t=0;t<this.treeProps.length;t++)if(this.obTreeRows[t]={LIST:BX(s+this.treeProps[t].ID+"_list"),CONT:BX(s+this.treeProps[t].ID+"_cont")},!this.obTreeRows[t].LIST||!this.obTreeRows[t].CONT){this.errorCode=-512;break}this.visual.QUANTITY_MEASURE&&(this.obMeasure=BX(this.visual.QUANTITY_MEASURE))}if(this.visual.BUY_ID&&(this.obBuyBtn=BX(this.visual.BUY_ID)),this.showPercent&&(this.visual.DSC_PERC&&(this.obDscPerc=BX(this.visual.DSC_PERC)),this.secondPict&&this.visual.SECOND_DSC_PERC&&(this.obSecondDscPerc=BX(this.visual.SECOND_DSC_PERC))),this.showSkuProps&&this.visual.DISPLAY_PROP_DIV&&(this.obSkuProps=BX(this.visual.DISPLAY_PROP_DIV)),0===this.errorCode){switch(this.showQuantity&&(this.obQuantityUp&&BX.bind(this.obQuantityUp,"click",BX.delegate(this.QuantityUp,this)),this.obQuantityDown&&BX.bind(this.obQuantityDown,"click",BX.delegate(this.QuantityDown,this)),this.obQuantity&&BX.bind(this.obQuantity,"change",BX.delegate(this.QuantityChange,this))),this.productType){case 1:break;case 3:for(var i in this.skuVisualParams){if((e=BX.findChildren(this.obTree,{tagName:this.skuVisualParams[i].TAG_BIND},!0))&&0<e.length)for(t=0;t<e.length;t++)$(e[t]).on(this.skuVisualParams[i].EVENT,BX.delegate(this.SelectOfferProp,this))}this.SetCurrent()}this.obBuyBtn&&BX.bind(this.obBuyBtn,"click",BX.delegate(this.Basket,this))}},t.JCSaleGiftProduct.prototype.checkHeight=function(){this.containerHeight=parseInt(this.obProduct.parentNode.offsetHeight,10),isNaN(this.containerHeight)&&(this.containerHeight=0)},t.JCSaleGiftProduct.prototype.setHeight=function(){0<this.containerHeight&&BX.adjust(this.obProduct.parentNode,{style:{height:this.containerHeight+"px"}})},t.JCSaleGiftProduct.prototype.clearHeight=function(){BX.adjust(this.obProduct.parentNode,{style:{height:"auto"}})},t.JCSaleGiftProduct.prototype.QuantityUp=function(){var t=0,s=!0;0===this.errorCode&&this.showQuantity&&this.canBuy&&(t=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10),isNaN(t)||(t+=this.stepQuantity,this.checkQuantity&&t>this.maxQuantity&&(s=!1),s&&(this.isDblQuantity&&(t=Math.round(t*this.precisionFactor)/this.precisionFactor),this.obQuantity.value=t)))},t.JCSaleGiftProduct.prototype.QuantityDown=function(){var t=0,s=!0;0===this.errorCode&&this.showQuantity&&this.canBuy&&(t=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10),isNaN(t)||((t-=this.stepQuantity)<this.stepQuantity&&(s=!1),s&&(this.isDblQuantity&&(t=Math.round(t*this.precisionFactor)/this.precisionFactor),this.obQuantity.value=t)))},t.JCSaleGiftProduct.prototype.QuantityChange=function(){var t=0,s=!0;0===this.errorCode&&this.showQuantity&&(this.canBuy?(t=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10),isNaN(t)?this.obQuantity.value=this.stepQuantity:(this.checkQuantity&&(t>this.maxQuantity?(s=!1,t=this.maxQuantity):t<this.stepQuantity&&(s=!1,t=this.stepQuantity)),s||(this.obQuantity.value=t))):this.obQuantity.value=this.stepQuantity)},t.JCSaleGiftProduct.prototype.QuantitySet=function(t){0===this.errorCode&&(this.canBuy=this.offers[t].CAN_BUY,this.currentPriceMode=this.offers[t].ITEM_PRICE_MODE,this.currentPrices=this.offers[t].ITEM_PRICES,this.currentPriceSelected=this.offers[t].ITEM_PRICE_SELECTED,this.currentQuantityRanges=this.offers[t].ITEM_QUANTITY_RANGES,this.currentQuantityRangeSelected=this.offers[t].ITEM_QUANTITY_RANGE_SELECTED,this.canBuy?(this.obBasketActions&&BX.style(this.obBasketActions,"display",""),this.obNotAvail&&BX.style(this.obNotAvail,"display","none")):(this.obBasketActions&&(BX.style(this.obBasketActions,"opacity","0"),BX.style(BX.findParent(BX(this.obQuantity),{class:"counter_block"}),"display","none")),this.obNotAvail&&BX.style(this.obNotAvail,"display","")),this.showQuantity&&(this.isDblQuantity=this.offers[t].QUANTITY_FLOAT,this.checkQuantity=this.offers[t].CHECK_QUANTITY,this.isDblQuantity?(this.maxQuantity=parseFloat(this.offers[t].MAX_QUANTITY),this.stepQuantity=Math.round(parseFloat(this.offers[t].STEP_QUANTITY)*this.precisionFactor)/this.precisionFactor):(this.maxQuantity=parseInt(this.offers[t].MAX_QUANTITY,10),this.stepQuantity=parseInt(this.offers[t].STEP_QUANTITY,10)),this.obQuantity&&(this.obQuantity.value=this.defaultCount,this.obQuantity.disabled=!this.canBuy),this.obMeasure&&(this.offers[t].MEASURE?BX.adjust(this.obMeasure,{html:this.offers[t].MEASURE}):BX.adjust(this.obMeasure,{html:""}))),this.currentBasisPrice=this.offers[t].BASIS_PRICE)},t.JCSaleGiftProduct.prototype.SelectOfferProp=function(){var t=0,s="",e="",i=[],o=null,r=BX.proxy_context;if(r&&r.hasAttribute("data-treevalue")&&(e=r.getAttribute("data-treevalue"),propModes=r.getAttribute("data-showtype"),i=e.split("_"),this.SearchOfferPropIndex(i[0],i[1])&&(o=BX.findChildren(r.parentNode,{tagName:this.skuVisualParams[propModes.toUpperCase()].TAG},!1))&&0<o.length))for(t=0;t<o.length;t++)s=o[t].getAttribute("data-onevalue"),"TEXT"==propModes?s===i[1]?o[t].setAttribute("selected","selected"):o[t].removeAttribute("selected"):s===i[1]?$(o[t]).addClass(this.skuVisualParams[propModes.toUpperCase()].ACTIVE_CLASS):$(o[t]).removeClass(this.skuVisualParams[propModes.toUpperCase()].ACTIVE_CLASS)},t.JCSaleGiftProduct.prototype.SearchOfferPropIndex=function(t,s){var e,i,o="",r=!1,a=[],n=-1,h={},u=[];for(e=0;e<this.treeProps.length;e++)if(this.treeProps[e].ID===t){n=e;break}if(-1<n){for(e=0;e<n;e++)h[o="PROP_"+this.treeProps[e].ID]=this.selectedValues[o];if(o="PROP_"+this.treeProps[n].ID,!(r=this.GetRowValues(h,o)))return!1;if(!BX.util.in_array(s,r))return!1;for(h[o]=s,e=n+1;e<this.treeProps.length;e++){if(o="PROP_"+this.treeProps[e].ID,!(r=this.GetRowValues(h,o)))return!1;if(this.showAbsent)for(a=[],u=[],u=BX.clone(h,!0),i=0;i<r.length;i++)u[o]=r[i],this.GetCanBuy(u)&&(a[a.length]=r[i]);else a=r;this.selectedValues[o]&&BX.util.in_array(this.selectedValues[o],a)?h[o]=this.selectedValues[o]:h[o]=a[0],this.UpdateRow(e,h[o],r,a)}this.selectedValues=h,this.ChangeInfo()}return!0},t.JCSaleGiftProduct.prototype.RowLeft=function(){var t=0,s="",e=-1,i=BX.proxy_context;if(i&&i.hasAttribute("data-treevalue")){for(s=i.getAttribute("data-treevalue"),t=0;t<this.treeProps.length;t++)if(this.treeProps[t].ID===s){e=t;break}-1<e&&this.treeRowShowSize<this.showCount[e]&&(0>this.showStart[e]&&(this.showStart[e]++,BX.adjust(this.obTreeRows[e].LIST,{style:{marginLeft:20*this.showStart[e]+"%"}}),BX.adjust(this.obTreeRows[e].RIGHT,{style:this.treeEnableArrow})),0<=this.showStart[e]&&BX.adjust(this.obTreeRows[e].LEFT,{style:this.treeDisableArrow}))}},t.JCSaleGiftProduct.prototype.RowRight=function(){var t=0,s="",e=-1,i=BX.proxy_context;if(i&&i.hasAttribute("data-treevalue")){for(s=i.getAttribute("data-treevalue"),t=0;t<this.treeProps.length;t++)if(this.treeProps[t].ID===s){e=t;break}-1<e&&this.treeRowShowSize<this.showCount[e]&&(this.treeRowShowSize-this.showStart[e]<this.showCount[e]&&(this.showStart[e]--,BX.adjust(this.obTreeRows[e].LIST,{style:{marginLeft:20*this.showStart[e]+"%"}}),BX.adjust(this.obTreeRows[e].LEFT,{style:this.treeEnableArrow})),this.treeRowShowSize-this.showStart[e]>=this.showCount[e]&&BX.adjust(this.obTreeRows[e].RIGHT,{style:this.treeDisableArrow}))}},t.JCSaleGiftProduct.prototype.UpdateRow=function(t,s,e,i){var o=0,r=0,a="",n=0,h={},u=!1,c=(this.treeEnableArrow,this.treeEnableArrow,null);if(-1<t&&t<this.obTreeRows.length&&(propMode=this.treeProps[t].DISPLAY_TYPE,(c=BX.findChildren(this.obTreeRows[t].LIST,{tagName:this.skuVisualParams[propMode].TAG},!1))&&0<c.length)){for(selectMode="SELECT"===this.treeProps[t].DISPLAY_TYPE,n=e.length,h={style:{},props:{disabled:"",selected:""}},o=0;o<c.length;o++)u=(a=c[o].getAttribute("data-onevalue"))===s&&0!=a,BX.util.in_array(a,i)?h.props.className=u?this.skuVisualParams[propMode].ACTIVE_CLASS:"":h.props.className=u?this.skuVisualParams[propMode].ACTIVE_CLASS+" "+this.skuVisualParams[propMode].HIDE_CLASS:this.skuVisualParams[propMode].HIDE_CLASS,selectMode?(h.props.disabled="disabled",h.props.selected=u?"selected":""):h.style.display="none",BX.util.in_array(a,e)&&(selectMode?h.props.disabled="":h.style.display="",u&&r,r++),BX.adjust(c[o],h);selectMode&&$(this.obTreeRows[t].LIST).parent().hasClass("ik_select")&&$(this.obTreeRows[t].LIST).ikSelect("reset"),this.showCount[t]=n,this.showStart[t]=0}},t.JCSaleGiftProduct.prototype.GetRowValues=function(t,s){var e,i=0,o=[],r=!1,a=!0;if(0===t.length){for(i=0;i<this.offers.length;i++)BX.util.in_array(this.offers[i].TREE[s],o)||(o[o.length]=this.offers[i].TREE[s]);r=!0}else for(i=0;i<this.offers.length;i++){a=!0;for(e in t)if(t[e]!==this.offers[i].TREE[e]){a=!1;break}a&&(BX.util.in_array(this.offers[i].TREE[s],o)||(o[o.length]=this.offers[i].TREE[s]),r=!0)}return!!r&&o},t.JCSaleGiftProduct.prototype.GetCanBuy=function(t){var s,e=0,i=!1,o=!0;for(e=0;e<this.offers.length;e++){o=!0;for(s in t)if(t[s]!==this.offers[e].TREE[s]){o=!1;break}if(o&&this.offers[e].CAN_BUY){i=!0;break}}return i},t.JCSaleGiftProduct.prototype.SetCurrent=function(){var t=0,s=0,e=[],i="",o=!1,r={},a=[],n=this.offers[this.offerNum].TREE;for(t=0;t<this.treeProps.length&&(i="PROP_"+this.treeProps[t].ID,o=this.GetRowValues(r,i));t++){if(BX.util.in_array(n[i],o)?r[i]=n[i]:(r[i]=o[0],this.offerNum=0),this.showAbsent)for(e=[],a=[],a=BX.clone(r,!0),s=0;s<o.length;s++)a[i]=o[s],this.GetCanBuy(a)&&(e[e.length]=o[s]);else e=o;this.UpdateRow(t,r[i],o,e)}this.selectedValues=r,this.ChangeInfo()},t.JCSaleGiftProduct.prototype.ChangeInfo=function(){var s,e=0,i=-1,o={},r=!0;for(e=0;e<this.offers.length;e++){r=!0;for(s in this.selectedValues)if(this.selectedValues[s]!==this.offers[e].TREE[s]){r=!1;break}if(r){i=e;break}}if(-1<i){if(this.obPict){o={attrs:{}};this.offers[i].PREVIEW_PICTURE?o.attrs.src=this.offers[i].PREVIEW_PICTURE.SRC:o.attrs.src=this.defaultPict.pict.SRC,BX.adjust(BX.findChild(this.obPict,{tag:"img"}),o)}this.showSkuProps&&this.obSkuProps&&(0===this.offers[i].DISPLAY_PROPERTIES.length?BX.adjust(this.obSkuProps,{style:{display:"none"},html:""}):BX.adjust(this.obSkuProps,{style:{display:""},html:this.offers[i].DISPLAY_PROPERTIES})),this.setQuantityStore(this.offers[i].MAX_QUANTITY,this.offers[i].AVAILIABLE.TEXT),this.offerNum=i,this.QuantitySet(this.offerNum),$(this.obProduct).find(".quantity_block .values").length&&$(this.obProduct).find(".quantity_block .values .item span").text(this.offers[i].MAX_QUANTITY).css({opacity:"1"}),"Y"==this.offers[i].SHOW_DISCOUNT_TIME_EACH_SKU&&initCountdownTime($(this.obProduct),this.offers[i].DISCOUNT_ACTIVE);var a=this.offers[i],n=$(this.obProduct),h=this;"undefined"!=typeof arBasketAspro?this.setActualDataBlock(n,a):void 0!==t.frameCacheVars&&BX.addCustomEvent("onFrameDataReceived",function(){h.setActualDataBlock(n,a)})}},t.JCSaleGiftProduct.prototype.setActualDataBlock=function(t,s){this.setLikeBlock(t,".like_icons .wish_item_button",s,"DELAY"),this.setLikeBlock(t,".like_icons .compare_item_button",s,"COMPARE"),this.setBuyBlock(t,s)},t.JCSaleGiftProduct.prototype.setLikeBlock=function(t,s,e,i){var o=t;"DELAY"==i&&(e.CAN_BUY?o.find(s).css("display","block"):o.find(s).hide()),o.find(s).attr("data-item",e.ID),o.find(s).find("span").attr("data-item",e.ID),arBasketAspro[i]&&(o.find(s).find(".to").removeClass("added").css("display","block"),o.find(s).find(".in").hide(),void 0!==arBasketAspro[i][e.ID]&&(o.find(s).find(".to").hide(),o.find(s).find(".in").css("display","block")))},t.JCSaleGiftProduct.prototype.setBuyBlock=function(t,s){var e=t.find(".offer_buy_block"),i=s.CONFIG.MIN_QUANTITY_BUY;if(e.find(".counter_wrapp .counter_block").length&&e.find(".counter_wrapp .counter_block").attr("data-item",s.ID),this.offers[this.offerNum].offer_set_quantity&&(i=this.offers[this.offerNum].offer_set_quantity),s.CONFIG.OPTIONS.USE_PRODUCT_QUANTITY_DETAIL&&"ADD"==s.CONFIG.ACTION&&s.CAN_BUY){var o=s.CONFIG.MAX_QUANTITY_BUY>0?"data-max='"+s.CONFIG.MAX_QUANTITY_BUY+"'":"",r='<span class="minus">-</span><input type="text" class="text" name="'+s.PRODUCT_QUANTITY_VARIABLE+'" value="'+i+'" /><span class="plus" '+o+">+</span>";arBasketAspro.BASKET&&void 0!==arBasketAspro.BASKET[s.ID]?e.find(".counter_wrapp .counter_block").length?e.find(".counter_wrapp .counter_block").hide():(e.find(".counter_wrapp").prepend('<div class="counter_block" data-item="'+s.ID+'"></div>'),e.find(".counter_wrapp .counter_block").html(r).hide()):e.find(".counter_wrapp .counter_block").length?e.find(".counter_wrapp .counter_block").html(r).show():(e.find(".counter_wrapp").prepend('<div class="counter_block" data-item="'+s.ID+'"></div>'),e.find(".counter_wrapp .counter_block").html(r))}else e.find(".counter_wrapp .counter_block").length&&e.find(".counter_wrapp .counter_block").hide();var a="ORDER"==s.CONFIG.ACTION||!s.CAN_BUY||!s.CONFIG.OPTIONS.USE_PRODUCT_QUANTITY_DETAIL||"SUBSCRIBE"==s.CONFIG.ACTION&&"Y"==s.CATALOG_SUBSCRIBE?"wide":"";$('<div class="button_block"></div>');if(e.find(".counter_wrapp").find(".button_block").length?arBasketAspro.BASKET&&void 0!==arBasketAspro.BASKET[s.ID]?(e.find(".counter_wrapp").find(".button_block").addClass("wide").html(s.HTML),markProductAddBasket(s.ID)):a?(e.find(".counter_wrapp").find(".button_block").addClass("wide").html(s.HTML),arBasketAspro.SUBSCRIBE&&void 0!==arBasketAspro.SUBSCRIBE[s.ID]&&markProductSubscribe(s.ID)):e.find(".counter_wrapp").find(".button_block").removeClass("wide").html(s.HTML):(e.find(".counter_wrapp").append('<div class="button_block '+a+'">'+s.HTML+"</div>"),arBasketAspro.BASKET&&void 0!==arBasketAspro.BASKET[s.ID]&&markProductAddBasket(s.ID),arBasketAspro.SUBSCRIBE&&void 0!==arBasketAspro.SUBSCRIBE[s.ID]&&markProductSubscribe(s.ID)),"NOTHING"!==s.CONFIG.ACTION)if("ADD"==s.CONFIG.ACTION&&s.CAN_BUY&&"N"!=s.SHOW_ONE_CLICK_BUY){var n='<span class="transparent big_btn type_block button one_click" data-offers="Y" data-item="'+s.ID+'" data-iblockID="'+s.IBLOCK_ID+'" data-quantity="'+s.CONFIG.MIN_QUANTITY_BUY+'" data-props="'+s.OFFER_PROPS+'" onclick="oneClickBuy('+s.ID+", "+s.IBLOCK_ID+', this)"><span>'+s.ONE_CLICK_BUY+"</span></span>";e.find(".wrapp_one_click").length?e.find(".wrapp_one_click").html(n):e.append('<div class="wrapp_one_click">'+n+"</div>")}else e.find(".wrapp_one_click").length&&e.find(".wrapp_one_click").remove();else e.find(".wrapp_one_click").length&&e.find(".wrapp_one_click").remove();e.fadeIn(),e.find(".counter_wrapp .counter_block input").data("product","ob"+this.obProduct.id);var h=s.MEASURE&&"Y"==s.SHOW_MEASURE?s.MEASURE:"";"PRICE"in s&&this.setPrice("","Y",s.PRICES,h,t,s)},t.JCSaleGiftProduct.prototype.setPrice=function(t,s,e,i,o,r){var a;if(this.obPrice){i=this.offers[this.offerNum].MEASURE&&"Y"==this.offers[this.offerNum].SHOW_MEASURE?this.offers[this.offerNum].MEASURE:"",o=$(this.obProduct);var n=this.offers[this.offerNum].PRICE,h="",u=n.PRINT_DISCOUNT_DIFF,c=void 0!==s&&"Y"==s;if(this.offers[this.offerNum].offer_set_quantity=this.offers[this.offerNum].CONFIG.MIN_QUANTITY_BUY,$(o).find("input[name=quantity]").length&&(this.offers[this.offerNum].offer_set_quantity=$(o).find("input[name=quantity]").val()),a='<span class="values_wrapper">'+getCurrentPrice(n.VALUE,n.CURRENCY,n.PRINT_VALUE)+"</span>",BX.adjust($(this.obPrice).closest(".cost").find(".price.discount")[0],{html:a}),u='<span class="values_wrapper">'+getCurrentPrice(n.DISCOUNT_VALUE,n.CURRENCY,n.PRINT_DISCOUNT_VALUE)+"</span>",i&&(u+="/"+i),BX.adjust(this.obPrice,{html:u}),n.DISCOUNT_VALUE!==n.VALUE&&this.showOldPrice&&n.DISCOUNT_VALUE>0?(price_value=BX.Currency.currencyFormat(n.VALUE*this.offers[this.offerNum].offer_set_quantity,n.CURRENCY),price_value_old=BX.Currency.currencyFormat(n.VALUE,n.CURRENCY),$(this.obPriceOld).find("strike").show().html('<span class="values_wrapper">'+n.PRINT_VALUE.replace(price_value_old,price_value)+"</span>"),this.showPercent&&n.DISCOUNT_VALUE&&($(this.obPriceOld).closest(".cost").find(".sale_block").show(),$(this.obPriceOld).closest(".cost").find(".value").html(n.DISCOUNT_DIFF_PERCENT_RAW),$(this.obPriceOld).closest(".cost").find(".text span").html(BX.Currency.currencyFormat(n.DISCOUNT_DIFF,n.CURRENCY,!0)))):($(this.obPriceOld).find("strike").hide().html(""),this.showPercent&&$(this.obPrice).closest(".cost").find(".sale_block").hide()),"Y"==arMShopOptions.THEME.SHOW_TOTAL_SUMM){if(this.offers[this.offerNum].check_quantity)h="Y";else(h=void 0!==t&&"Y"==t?t:"")&&(this.offers[this.offerNum].check_quantity=!0);setPriceItem(o,this.offers[this.offerNum].offer_set_quantity,"",h,c)}}},t.JCSaleGiftProduct.prototype.setQuantityStore=function(t,s){parseFloat(t)>0?$(this.storeQuanity).find(".icon").removeClass("order").addClass("stock"):$(this.storeQuanity).find(".icon").removeClass("stock").addClass("order"),$(this.storeQuanity).find(".icon + span").html(s)},t.JCSaleGiftProduct.prototype.InitBasketUrl=function(){switch(this.productType){case 1:case 2:this.basketUrl=this.product.addUrl;break;case 3:this.basketUrl=this.offers[this.offerNum].ADD_URL}this.basketParams={ajax_basket:"Y"},this.showQuantity&&(this.basketParams[this.basketData.quantity]=this.obQuantity.value)},t.JCSaleGiftProduct.prototype.FillBasketProps=function(){if(this.visual.BASKET_PROP_DIV){var t=0,s=null,e=!1,i=null;if(this.basketData.useProps&&!this.basketData.emptyProps?this.obPopupWin&&this.obPopupWin.contentContainer&&(i=this.obPopupWin.contentContainer):i=BX(this.visual.BASKET_PROP_DIV),i){if((s=i.getElementsByTagName("select"))&&s.length)for(t=0;t<s.length;t++)if(!s[t].disabled)switch(s[t].type.toLowerCase()){case"select-one":this.basketParams[s[t].name]=s[t].value,e=!0}if((s=i.getElementsByTagName("input"))&&s.length)for(t=0;t<s.length;t++)if(!s[t].disabled)switch(s[t].type.toLowerCase()){case"hidden":this.basketParams[s[t].name]=s[t].value,e=!0;break;case"radio":s[t].checked&&(this.basketParams[s[t].name]=s[t].value,e=!0)}e||(this.basketParams[this.basketData.props]=[],this.basketParams[this.basketData.props][0]=0)}}},t.JCSaleGiftProduct.prototype.SendToBasket=function(){this.canBuy&&(this.InitBasketUrl(),this.FillBasketProps(),BX.ajax.loadJSON(this.basketUrl,this.basketParams,BX.delegate(this.BasketResult,this)))},t.JCSaleGiftProduct.prototype.Basket=function(){var t="";if(this.canBuy)switch(this.productType){case 1:case 2:this.basketData.useProps&&!this.basketData.emptyProps?(this.InitPopupWindow(),this.obPopupWin.setTitleBar({content:BX.create("div",{style:{marginRight:"30px",whiteSpace:"nowrap"},text:BX.message("CVP_TITLE_BASKET_PROPS")})}),BX(this.visual.BASKET_PROP_DIV)&&(t=BX(this.visual.BASKET_PROP_DIV).innerHTML),this.obPopupWin.setContent(t),this.obPopupWin.setButtons([new s({ownerClass:this.obProduct.parentNode.parentNode.parentNode.className,text:BX.message("CVP_BTN_MESSAGE_SEND_PROPS"),events:{click:BX.delegate(this.SendToBasket,this)}})]),this.obPopupWin.show()):this.SendToBasket();break;case 3:this.SendToBasket()}},t.JCSaleGiftProduct.prototype.BasketResult=function(t){var e,i="",o="",r="",a=[];if(this.obPopupWin&&this.obPopupWin.close(),"object"!=typeof t)return!1;if(e="OK"===t.STATUS){switch(BX.onCustomEvent("OnBasketChange"),o=this.product.name,this.productType){case 1:case 2:r=this.product.pict.SRC;break;case 3:r=this.offers[this.offerNum].PREVIEW_PICTURE?this.offers[this.offerNum].PREVIEW_PICTURE.SRC:this.defaultPict.pict.SRC}i='<div style="width: 96%; margin: 10px 2%; text-align: center;"><img src="'+r+'" height="130" style="max-height:130px"><p>'+o+"</p></div>",a=[new s({ownerClass:this.obProduct.parentNode.parentNode.parentNode.className,text:BX.message("CVP_BTN_MESSAGE_BASKET_REDIRECT"),events:{click:BX.delegate(function(){location.href=this.basketData.basketUrl?this.basketData.basketUrl:BX.message("CVP_BASKET_URL")},this)}})]}else i=t.MESSAGE?t.MESSAGE:BX.message("CVP_BASKET_UNKNOWN_ERROR"),a=[new s({ownerClass:this.obProduct.parentNode.parentNode.parentNode.className,text:BX.message("CVP_BTN_MESSAGE_CLOSE"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})];this.InitPopupWindow(),this.obPopupWin.setTitleBar({content:BX.create("div",{style:{marginRight:"30px",whiteSpace:"nowrap"},text:e?BX.message("CVP_TITLE_SUCCESSFUL"):BX.message("CVP_TITLE_ERROR")})}),this.obPopupWin.setContent(i),this.obPopupWin.setButtons(a),this.obPopupWin.show()},t.JCSaleGiftProduct.prototype.InitPopupWindow=function(){this.obPopupWin||(this.obPopupWin=BX.PopupWindowManager.create("CatalogSectionBasket_"+this.visual.ID,null,{autoHide:!1,offsetLeft:0,offsetTop:0,overlay:!0,closeByEsc:!0,titleBar:!0,closeIcon:{top:"10px",right:"10px"}}))}}}(window);
/* End */
;
; /* Start:"a:4:{s:4:"full";s:105:"/bitrix/templates/aspro_mshop/components/bitrix/sale.gift.main.products/main/script.min.js?15174033412661";s:6:"source";s:86:"/bitrix/templates/aspro_mshop/components/bitrix/sale.gift.main.products/main/script.js";s:3:"min";s:90:"/bitrix/templates/aspro_mshop/components/bitrix/sale.gift.main.products/main/script.min.js";s:3:"map";s:90:"/bitrix/templates/aspro_mshop/components/bitrix/sale.gift.main.products/main/script.map.js";}"*/
BX.namespace("BX.Sale");BX.Sale.GiftMainProductsClass=function(){var t=function(t){this.ajaxUrl="/bitrix/components/bitrix/sale.gift.main.products/ajax.php";this.contextAjaxData=t.contextAjaxData||{};this.mainProductState=t.mainProductState||null;this.injectId=t.injectId||null;this.isGift=!!t.isGift;this.productId=t.productId;this.offerId=t.offerId;this.offers=t.offers||[];this.setEvents();if(document.location.hash.match(/as_gift/g)){if(this.isGift){this.enableGift()}else{this.raiseNonGiftEvent()}}BX.bindDelegate(BX(this.injectId),"click",{tagName:"a"},BX.proxy(this.clickNavLink,this))};t.prototype.clickNavLink=function(t){if(this.onPageNavigationByLink(BX.proxy_context)){return BX.PreventDefault(t)}};t.prototype.setEvents=function(){BX.addCustomEvent("onCatalogStoreProductChange",BX.proxy(this.onCatalogStoreProductChange,this));BX.addCustomEvent("onAddToBasketMainProduct",BX.proxy(this.onAddToBasketMainProduct,this))};t.prototype.unsubscribeEvents=function(){BX.removeCustomEvent("onCatalogStoreProductChange",BX.proxy(this.onCatalogStoreProductChange,this))};t.prototype.onAddToBasketMainProduct=function(t){this.enableGift()};t.prototype.onCatalogStoreProductChange=function(t){if(t==this.offerId){return}BX.ajax({url:this.ajaxUrl,method:"POST",data:BX.merge(this.contextAjaxData,{offerId:t,mainProductState:this.mainProductState,SITE_ID:BX.message("SITE_ID")}),dataType:"html",processData:false,start:true,onsuccess:BX.delegate(function(e){this.offerId=t;var i=BX.processHTML(e);if(!i.HTML){if(document.location.hash.match(/as_gift/g)){if(this.isGift){this.raiseGiftEvent()}else{this.raiseNonGiftEvent()}}return}this.unsubscribeEvents();BX(this.injectId).innerHTML=i.HTML;BX.ajax.processScripts(i.SCRIPT)},this)})};t.prototype.onPageNavigationByLink=function(t){var e=BX.delegate(function(t){if(!BX.type.isElementNode(t)||!t.href){return false}if(t.href.indexOf(this.ajaxUrl)>=0){return true}return t.href.indexOf("PAGEN_")!==-1},this);if(!e(t)){return false}BX.ajax({url:t.href,method:"POST",data:BX.merge(this.contextAjaxData,{SITE_ID:BX.message("SITE_ID")}),dataType:"html",processData:false,start:true,onsuccess:BX.delegate(function(t){var e=BX.processHTML(t);if(!e.HTML){return}this.unsubscribeEvents();BX(this.injectId).innerHTML=e.HTML;BX.ajax.processScripts(e.SCRIPT)},this)});return true};t.prototype.enableGift=function(){this.isGift=true;this.raiseGiftEvent()};t.prototype.raiseGiftEvent=function(){BX.onCustomEvent("onSaleProductIsGift",[this.productId,this.offerId])};t.prototype.raiseNonGiftEvent=function(){BX.onCustomEvent("onSaleProductIsNotGift",[this.productId,this.offerId])};return t}();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:111:"/bitrix/templates/aspro_mshop/components/bitrix/catalog.bigdata.products/main_new/script.min.js?151740334123198";s:6:"source";s:91:"/bitrix/templates/aspro_mshop/components/bitrix/catalog.bigdata.products/main_new/script.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
function getCookie(t){var s=document.cookie.match(new RegExp("(?:^|; )"+t.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return s?decodeURIComponent(s[1]):void 0}function bx_rcm_recommendation_event_attaching(t){return null}function bx_rcm_adaptive_recommendation_event_attaching(t,s){var e=BX(s);e||(e=document.body);var i=BX.findChildren(e,{tag:"a"},!0);if(i){var o;for(o in i)BX.bind(i[o],"click",function(s){var e,i=BX(this);for(e in t)if(t[e].productUrl==i.getAttribute("href")){window.JCCatalogBigdataProducts.prototype.RememberProductRecommendation(t[e].recommendationId,t[e].productId);break}})}}function bx_rcm_get_from_cloud(t,s,e){var i="https://analytics.bitrix.info/crecoms/v1_0/recoms.php",o=BX.ajax.prepareData(s);o&&(i+=(-1!==i.indexOf("?")?"&":"?")+o);var a=function(s){s.items||(s.items=[]),BX.ajax({url:"/bitrix/components/bitrix/catalog.bigdata.products/ajax.php?"+BX.ajax.prepareData({AJAX_ITEMS:s.items,RID:s.id}),method:"POST",data:e,dataType:"html",processData:!1,start:!0,onsuccess:function(s){var e=BX.processHTML(s);BX(t).innerHTML=e.HTML,BX.ajax.processScripts(e.SCRIPT),setTimeout(function(){$(".RECOMENDATION_slides").length||$(".specials_slider_wrapp1 li[data-code=RECOMENDATION]").remove(),$('.top_blocks li[data-code="RECOMENDATION"]').hasClass("cur")&&$('.top_blocks li[data-code="RECOMENDATION"]').trigger("click")},200)}})};BX.ajax({method:"GET",dataType:"json",url:i,timeout:3,onsuccess:a,onfailure:a})}!function(t){if(!t.JCCatalogBigdataProducts){var s=function(t){s.superclass.constructor.apply(this,arguments),this.nameNode=BX.create("span",{props:{className:"bx_medium bx_bt_button",id:this.id},text:t.text}),this.buttonNode=BX.create("span",{attrs:{className:t.ownerClass},style:{marginBottom:"0",borderBottom:"0 none transparent"},children:[this.nameNode],events:this.contextEvents}),BX.browser.IsIE()&&this.buttonNode.setAttribute("hideFocus","hidefocus")};BX.extend(s,BX.PopupWindowButton),t.JCCatalogBigdataProducts=function(t){if(this.productType=0,this.showQuantity=!0,this.showAbsent=!0,this.secondPict=!1,this.showOldPrice=!1,this.showPercent=!1,this.showSkuProps=!1,this.visual={ID:"",PICT_ID:"",SECOND_PICT_ID:"",QUANTITY_ID:"",QUANTITY_UP_ID:"",QUANTITY_DOWN_ID:"",PRICE_ID:"",DSC_PERC:"",SECOND_DSC_PERC:"",DISPLAY_PROP_DIV:"",BASKET_PROP_DIV:""},this.product={checkQuantity:!1,maxQuantity:0,stepQuantity:1,isDblQuantity:!1,canBuy:!0,canSubscription:!0,name:"",pict:{},id:0,addUrl:"",buyUrl:""},this.basketData={useProps:!1,emptyProps:!1,quantity:"quantity",props:"prop",basketUrl:""},this.defaultPict={pict:null,secondPict:null},this.checkQuantity=!1,this.maxQuantity=0,this.stepQuantity=1,this.isDblQuantity=!1,this.canBuy=!0,this.canSubscription=!0,this.precision=6,this.precisionFactor=Math.pow(10,this.precision),this.offers=[],this.offerNum=0,this.treeProps=[],this.obTreeRows=[],this.showCount=[],this.showStart=[],this.selectedValues={},this.obProduct=null,this.obQuantity=null,this.obQuantityUp=null,this.obQuantityDown=null,this.obPict=null,this.obSecondPict=null,this.obPrice=null,this.obTree=null,this.obBuyBtn=null,this.obDscPerc=null,this.obSecondDscPerc=null,this.obSkuProps=null,this.obMeasure=null,this.obPopupWin=null,this.basketUrl="",this.basketParams={},this.treeRowShowSize=5,this.treeEnableArrow={display:"",cursor:"pointer",opacity:1},this.treeDisableArrow={display:"",cursor:"default",opacity:.2},this.lastElement=!1,this.containerHeight=0,this.errorCode=0,"object"==typeof t){switch(this.productType=parseInt(t.PRODUCT_TYPE,10),this.showQuantity=t.SHOW_QUANTITY,this.showAbsent=t.SHOW_ABSENT,this.secondPict=!!t.SECOND_PICT,this.showOldPrice=!!t.SHOW_OLD_PRICE,this.showPercent=!!t.SHOW_DISCOUNT_PERCENT,this.showSkuProps=!!t.SHOW_SKU_PROPS,this.visual=t.VISUAL,this.productType){case 1:case 2:t.PRODUCT&&"object"==typeof t.PRODUCT?(this.showQuantity&&(this.product.checkQuantity=t.PRODUCT.CHECK_QUANTITY,this.product.isDblQuantity=t.PRODUCT.QUANTITY_FLOAT,this.product.checkQuantity&&(this.product.maxQuantity=this.product.isDblQuantity?parseFloat(t.PRODUCT.MAX_QUANTITY):parseInt(t.PRODUCT.MAX_QUANTITY,10)),this.product.stepQuantity=this.product.isDblQuantity?parseFloat(t.PRODUCT.STEP_QUANTITY):parseInt(t.PRODUCT.STEP_QUANTITY,10),this.checkQuantity=this.product.checkQuantity,this.isDblQuantity=this.product.isDblQuantity,this.maxQuantity=this.product.maxQuantity,this.stepQuantity=this.product.stepQuantity,this.isDblQuantity&&(this.stepQuantity=Math.round(this.stepQuantity*this.precisionFactor)/this.precisionFactor)),this.product.canBuy=t.PRODUCT.CAN_BUY,this.product.canSubscription=t.PRODUCT.SUBSCRIPTION,this.canBuy=this.product.canBuy,this.canSubscription=this.product.canSubscription,this.product.name=t.PRODUCT.NAME,this.product.pict=t.PRODUCT.PICT,this.product.id=t.PRODUCT.ID,t.PRODUCT.ADD_URL&&(this.product.addUrl=t.PRODUCT.ADD_URL),t.PRODUCT.BUY_URL&&(this.product.buyUrl=t.PRODUCT.BUY_URL),t.BASKET&&"object"==typeof t.BASKET&&(this.basketData.useProps=!!t.BASKET.ADD_PROPS,this.basketData.emptyProps=!!t.BASKET.EMPTY_PROPS)):this.errorCode=-1;break;case 3:t.OFFERS&&BX.type.isArray(t.OFFERS)?(t.PRODUCT&&"object"==typeof t.PRODUCT&&(this.product.name=t.PRODUCT.NAME,this.product.id=t.PRODUCT.ID),this.offers=t.OFFERS,this.offerNum=0,t.OFFER_SELECTED&&(this.offerNum=parseInt(t.OFFER_SELECTED,10)),isNaN(this.offerNum)&&(this.offerNum=0),t.TREE_PROPS&&(this.treeProps=t.TREE_PROPS),t.DEFAULT_PICTURE&&(this.defaultPict.pict=t.DEFAULT_PICTURE.PICTURE,this.defaultPict.secondPict=t.DEFAULT_PICTURE.PICTURE_SECOND)):this.errorCode=-1;break;default:this.errorCode=-1}t.BASKET&&"object"==typeof t.BASKET&&(t.BASKET.QUANTITY&&(this.basketData.quantity=t.BASKET.QUANTITY),t.BASKET.PROPS&&(this.basketData.props=t.BASKET.PROPS),t.BASKET.BASKET_URL&&(this.basketData.basketUrl=t.BASKET.BASKET_URL)),this.lastElement=!!t.LAST_ELEMENT&&"Y"===t.LAST_ELEMENT}0===this.errorCode&&BX.ready(BX.delegate(this.Init,this))},t.JCCatalogBigdataProducts.prototype.Init=function(){var s=0,e="",i=null;if(this.obProduct=BX(this.visual.ID),this.obProduct||(this.errorCode=-1),this.obPict=BX(this.visual.PICT_ID),this.obPict||(this.errorCode=-2),this.secondPict&&this.visual.SECOND_PICT_ID&&(this.obSecondPict=BX(this.visual.SECOND_PICT_ID)),this.obPrice=BX(this.visual.PRICE_ID),this.obPrice||(this.errorCode=-16),this.showQuantity&&this.visual.QUANTITY_ID&&(this.obQuantity=BX(this.visual.QUANTITY_ID),this.visual.QUANTITY_UP_ID&&(this.obQuantityUp=BX(this.visual.QUANTITY_UP_ID)),this.visual.QUANTITY_DOWN_ID&&(this.obQuantityDown=BX(this.visual.QUANTITY_DOWN_ID))),3===this.productType){if(this.visual.TREE_ID)for(this.obTree=BX(this.visual.TREE_ID),this.obTree||(this.errorCode=-256),e=this.visual.TREE_ITEM_ID,s=0;s<this.treeProps.length;s++)if(this.obTreeRows[s]={LEFT:BX(e+this.treeProps[s].ID+"_left"),RIGHT:BX(e+this.treeProps[s].ID+"_right"),LIST:BX(e+this.treeProps[s].ID+"_list"),CONT:BX(e+this.treeProps[s].ID+"_cont")},!(this.obTreeRows[s].LEFT&&this.obTreeRows[s].RIGHT&&this.obTreeRows[s].LIST&&this.obTreeRows[s].CONT)){this.errorCode=-512;break}this.visual.QUANTITY_MEASURE&&(this.obMeasure=BX(this.visual.QUANTITY_MEASURE))}if(this.visual.BUY_ID&&(this.obBuyBtn=BX(this.visual.BUY_ID)),this.showPercent&&(this.visual.DSC_PERC&&(this.obDscPerc=BX(this.visual.DSC_PERC)),this.secondPict&&this.visual.SECOND_DSC_PERC&&(this.obSecondDscPerc=BX(this.visual.SECOND_DSC_PERC))),this.showSkuProps&&this.visual.DISPLAY_PROP_DIV&&(this.obSkuProps=BX(this.visual.DISPLAY_PROP_DIV)),0===this.errorCode){switch(this.showQuantity&&(this.obQuantityUp&&BX.bind(this.obQuantityUp,"click",BX.delegate(this.QuantityUp,this)),this.obQuantityDown&&BX.bind(this.obQuantityDown,"click",BX.delegate(this.QuantityDown,this)),this.obQuantity&&BX.bind(this.obQuantity,"change",BX.delegate(this.QuantityChange,this))),this.productType){case 1:break;case 3:if((i=BX.findChildren(this.obTree,{tagName:"li"},!0))&&0<i.length)for(s=0;s<i.length;s++)BX.bind(i[s],"click",BX.delegate(this.SelectOfferProp,this));for(s=0;s<this.obTreeRows.length;s++)BX.bind(this.obTreeRows[s].LEFT,"click",BX.delegate(this.RowLeft,this)),BX.bind(this.obTreeRows[s].RIGHT,"click",BX.delegate(this.RowRight,this));this.SetCurrent()}this.obBuyBtn&&BX.bind(this.obBuyBtn,"click",BX.delegate(this.Basket,this)),this.lastElement&&(this.containerHeight=parseInt(this.obProduct.parentNode.offsetHeight,10),isNaN(this.containerHeight)&&(this.containerHeight=0),this.setHeight(),BX.bind(t,"resize",BX.delegate(this.checkHeight,this)),BX.bind(this.obProduct.parentNode,"mouseover",BX.delegate(this.setHeight,this)),BX.bind(this.obProduct.parentNode,"mouseout",BX.delegate(this.clearHeight,this)))}},t.JCCatalogBigdataProducts.prototype.checkHeight=function(){this.containerHeight=parseInt(this.obProduct.parentNode.offsetHeight,10),isNaN(this.containerHeight)&&(this.containerHeight=0)},t.JCCatalogBigdataProducts.prototype.setHeight=function(){0<this.containerHeight&&BX.adjust(this.obProduct.parentNode,{style:{height:this.containerHeight+"px"}})},t.JCCatalogBigdataProducts.prototype.clearHeight=function(){BX.adjust(this.obProduct.parentNode,{style:{height:"auto"}})},t.JCCatalogBigdataProducts.prototype.QuantityUp=function(){var t=0,s=!0;0===this.errorCode&&this.showQuantity&&this.canBuy&&(t=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10),isNaN(t)||(t+=this.stepQuantity,this.checkQuantity&&t>this.maxQuantity&&(s=!1),s&&(this.isDblQuantity&&(t=Math.round(t*this.precisionFactor)/this.precisionFactor),this.obQuantity.value=t)))},t.JCCatalogBigdataProducts.prototype.QuantityDown=function(){var t=0,s=!0;0===this.errorCode&&this.showQuantity&&this.canBuy&&(t=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10),isNaN(t)||((t-=this.stepQuantity)<this.stepQuantity&&(s=!1),s&&(this.isDblQuantity&&(t=Math.round(t*this.precisionFactor)/this.precisionFactor),this.obQuantity.value=t)))},t.JCCatalogBigdataProducts.prototype.QuantityChange=function(){var t=0,s=!0;0===this.errorCode&&this.showQuantity&&(this.canBuy?(t=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10),isNaN(t)?this.obQuantity.value=this.stepQuantity:(this.checkQuantity&&(t>this.maxQuantity?(s=!1,t=this.maxQuantity):t<this.stepQuantity&&(s=!1,t=this.stepQuantity)),s||(this.obQuantity.value=t))):this.obQuantity.value=this.stepQuantity)},t.JCCatalogBigdataProducts.prototype.QuantitySet=function(t){0===this.errorCode&&(this.canBuy=this.offers[t].CAN_BUY,this.canBuy?(BX.addClass(this.obBuyBtn,"bx_bt_button"),BX.removeClass(this.obBuyBtn,"bx_bt_button_type_2"),this.obBuyBtn.innerHTML=BX.message("CBD_MESS_BTN_BUY")):(BX.addClass(this.obBuyBtn,"bx_bt_button_type_2"),BX.removeClass(this.obBuyBtn,"bx_bt_button"),this.obBuyBtn.innerHTML=BX.message("CBD_MESS_NOT_AVAILABLE")),this.showQuantity&&(this.isDblQuantity=this.offers[t].QUANTITY_FLOAT,this.checkQuantity=this.offers[t].CHECK_QUANTITY,this.isDblQuantity?(this.maxQuantity=parseFloat(this.offers[t].MAX_QUANTITY),this.stepQuantity=Math.round(parseFloat(this.offers[t].STEP_QUANTITY)*this.precisionFactor)/this.precisionFactor):(this.maxQuantity=parseInt(this.offers[t].MAX_QUANTITY,10),this.stepQuantity=parseInt(this.offers[t].STEP_QUANTITY,10)),this.obQuantity.value=this.stepQuantity,this.obQuantity.disabled=!this.canBuy,this.obMeasure&&(this.offers[t].MEASURE?BX.adjust(this.obMeasure,{html:this.offers[t].MEASURE}):BX.adjust(this.obMeasure,{html:""}))))},t.JCCatalogBigdataProducts.prototype.SelectOfferProp=function(){var t=0,s="",e=[],i=null,o=BX.proxy_context;if(o&&o.hasAttribute("data-treevalue")&&(s=o.getAttribute("data-treevalue"),e=s.split("_"),this.SearchOfferPropIndex(e[0],e[1])&&(i=BX.findChildren(o.parentNode,{tagName:"li"},!1))&&0<i.length))for(t=0;t<i.length;t++)i[t].getAttribute("data-onevalue")===e[1]?BX.addClass(i[t],"bx_active"):BX.removeClass(i[t],"bx_active")},t.JCCatalogBigdataProducts.prototype.SearchOfferPropIndex=function(t,s){var e,i,o="",a=!1,r=[],h=-1,n={},u=[];for(e=0;e<this.treeProps.length;e++)if(this.treeProps[e].ID===t){h=e;break}if(-1<h){for(e=0;e<h;e++)n[o="PROP_"+this.treeProps[e].ID]=this.selectedValues[o];if(o="PROP_"+this.treeProps[h].ID,!(a=this.GetRowValues(n,o)))return!1;if(!BX.util.in_array(s,a))return!1;for(n[o]=s,e=h+1;e<this.treeProps.length;e++){if(o="PROP_"+this.treeProps[e].ID,!(a=this.GetRowValues(n,o)))return!1;if(this.showAbsent)for(r=[],u=[],u=BX.clone(n,!0),i=0;i<a.length;i++)u[o]=a[i],this.GetCanBuy(u)&&(r[r.length]=a[i]);else r=a;this.selectedValues[o]&&BX.util.in_array(this.selectedValues[o],r)?n[o]=this.selectedValues[o]:n[o]=r[0],this.UpdateRow(e,n[o],a,r)}this.selectedValues=n,this.ChangeInfo()}return!0},t.JCCatalogBigdataProducts.prototype.RowLeft=function(){var t=0,s="",e=-1,i=BX.proxy_context;if(i&&i.hasAttribute("data-treevalue")){for(s=i.getAttribute("data-treevalue"),t=0;t<this.treeProps.length;t++)if(this.treeProps[t].ID===s){e=t;break}-1<e&&this.treeRowShowSize<this.showCount[e]&&(0>this.showStart[e]&&(this.showStart[e]++,BX.adjust(this.obTreeRows[e].LIST,{style:{marginLeft:20*this.showStart[e]+"%"}}),BX.adjust(this.obTreeRows[e].RIGHT,{style:this.treeEnableArrow})),0<=this.showStart[e]&&BX.adjust(this.obTreeRows[e].LEFT,{style:this.treeDisableArrow}))}},t.JCCatalogBigdataProducts.prototype.RowRight=function(){var t=0,s="",e=-1,i=BX.proxy_context;if(i&&i.hasAttribute("data-treevalue")){for(s=i.getAttribute("data-treevalue"),t=0;t<this.treeProps.length;t++)if(this.treeProps[t].ID===s){e=t;break}-1<e&&this.treeRowShowSize<this.showCount[e]&&(this.treeRowShowSize-this.showStart[e]<this.showCount[e]&&(this.showStart[e]--,BX.adjust(this.obTreeRows[e].LIST,{style:{marginLeft:20*this.showStart[e]+"%"}}),BX.adjust(this.obTreeRows[e].LEFT,{style:this.treeEnableArrow})),this.treeRowShowSize-this.showStart[e]>=this.showCount[e]&&BX.adjust(this.obTreeRows[e].RIGHT,{style:this.treeDisableArrow}))}},t.JCCatalogBigdataProducts.prototype.UpdateRow=function(t,s,e,i){var o=0,a=0,r="",h=0,n="",u={},c=!1,l=!1,d=!1,p=0,P=this.treeEnableArrow,b=this.treeEnableArrow,B=0,T=null;if(-1<t&&t<this.obTreeRows.length&&(T=BX.findChildren(this.obTreeRows[t].LIST,{tagName:"li"},!1))&&0<T.length){for(c="PICT"===this.treeProps[t].SHOW_MODE,h=e.length,u={props:{className:""},style:{width:n=(l=this.treeRowShowSize<h)?100/h+"%":"20%"}},c&&(u.style.paddingTop=n),o=0;o<T.length;o++)d=(r=T[o].getAttribute("data-onevalue"))===s,BX.util.in_array(r,i)?u.props.className=d?"bx_active":"":u.props.className=d?"bx_active bx_missing":"bx_missing",u.style.display="none",BX.util.in_array(r,e)&&(u.style.display="",d&&(p=a),a++),BX.adjust(T[o],u);u={style:{width:(l?20*h:100)+"%",marginLeft:"0%"}},c?BX.adjust(this.obTreeRows[t].CONT,{props:{className:l?"bx_item_detail_scu full":"bx_item_detail_scu"}}):BX.adjust(this.obTreeRows[t].CONT,{props:{className:l?"bx_item_detail_size full":"bx_item_detail_size"}}),l?(p+1===h&&(b=this.treeDisableArrow),this.treeRowShowSize<=p&&(B=this.treeRowShowSize-p-1,u.style.marginLeft=20*B+"%"),0===B&&(P=this.treeDisableArrow),BX.adjust(this.obTreeRows[t].LEFT,{style:P}),BX.adjust(this.obTreeRows[t].RIGHT,{style:b})):(BX.adjust(this.obTreeRows[t].LEFT,{style:{display:"none"}}),BX.adjust(this.obTreeRows[t].RIGHT,{style:{display:"none"}})),BX.adjust(this.obTreeRows[t].LIST,u),this.showCount[t]=h,this.showStart[t]=B}},t.JCCatalogBigdataProducts.prototype.GetRowValues=function(t,s){var e,i=0,o=[],a=!1,r=!0;if(0===t.length){for(i=0;i<this.offers.length;i++)BX.util.in_array(this.offers[i].TREE[s],o)||(o[o.length]=this.offers[i].TREE[s]);a=!0}else for(i=0;i<this.offers.length;i++){r=!0;for(e in t)if(t[e]!==this.offers[i].TREE[e]){r=!1;break}r&&(BX.util.in_array(this.offers[i].TREE[s],o)||(o[o.length]=this.offers[i].TREE[s]),a=!0)}return!!a&&o},t.JCCatalogBigdataProducts.prototype.GetCanBuy=function(t){var s,e=0,i=!1,o=!0;for(e=0;e<this.offers.length;e++){o=!0;for(s in t)if(t[s]!==this.offers[e].TREE[s]){o=!1;break}if(o&&this.offers[e].CAN_BUY){i=!0;break}}return i},t.JCCatalogBigdataProducts.prototype.SetCurrent=function(){var t=0,s=0,e=[],i="",o=!1,a={},r=[],h=this.offers[this.offerNum].TREE;for(t=0;t<this.treeProps.length&&(i="PROP_"+this.treeProps[t].ID,o=this.GetRowValues(a,i));t++){if(BX.util.in_array(h[i],o)?a[i]=h[i]:(a[i]=o[0],this.offerNum=0),this.showAbsent)for(e=[],r=[],r=BX.clone(a,!0),s=0;s<o.length;s++)r[i]=o[s],this.GetCanBuy(r)&&(e[e.length]=o[s]);else e=o;this.UpdateRow(t,a[i],o,e)}this.selectedValues=a,this.ChangeInfo()},t.JCCatalogBigdataProducts.prototype.ChangeInfo=function(){var t,s=0,e=-1,i={},o=!0,a="";for(s=0;s<this.offers.length;s++){o=!0;for(t in this.selectedValues)if(this.selectedValues[t]!==this.offers[s].TREE[t]){o=!1;break}if(o){e=s;break}}-1<e&&(this.obPict&&(this.offers[e].PREVIEW_PICTURE?BX.adjust(this.obPict,{style:{backgroundImage:"url("+this.offers[e].PREVIEW_PICTURE.SRC+")"}}):BX.adjust(this.obPict,{style:{backgroundImage:"url("+this.defaultPict.pict.SRC+")"}})),this.secondPict&&this.obSecondPict&&(this.offers[e].PREVIEW_PICTURE_SECOND?BX.adjust(this.obSecondPict,{style:{backgroundImage:"url("+this.offers[e].PREVIEW_PICTURE_SECOND.SRC+")"}}):this.offers[e].PREVIEW_PICTURE.SRC?BX.adjust(this.obSecondPict,{style:{backgroundImage:"url("+this.offers[e].PREVIEW_PICTURE.SRC+")"}}):this.defaultPict.secondPict?BX.adjust(this.obSecondPict,{style:{backgroundImage:"url("+this.defaultPict.secondPict.SRC+")"}}):BX.adjust(this.obSecondPict,{style:{backgroundImage:"url("+this.defaultPict.pict.SRC+")"}})),this.showSkuProps&&this.obSkuProps&&(0===this.offers[e].DISPLAY_PROPERTIES.length?BX.adjust(this.obSkuProps,{style:{display:"none"},html:""}):BX.adjust(this.obSkuProps,{style:{display:""},html:this.offers[e].DISPLAY_PROPERTIES})),this.obPrice&&(a=this.offers[e].PRICE.PRINT_DISCOUNT_VALUE,this.showOldPrice&&this.offers[e].PRICE.DISCOUNT_VALUE!==this.offers[e].PRICE.VALUE&&(a+=" <span>"+this.offers[e].PRICE.PRINT_VALUE+"</span>"),BX.adjust(this.obPrice,{html:a}),this.showPercent&&(i=this.offers[e].PRICE.DISCOUNT_VALUE!==this.offers[e].PRICE.VALUE?{style:{display:""},html:this.offers[e].PRICE.DISCOUNT_DIFF_PERCENT}:{style:{display:"none"},html:""},this.obDscPerc&&BX.adjust(this.obDscPerc,i),this.obSecondDscPerc&&BX.adjust(this.obSecondDscPerc,i))),this.offerNum=e,this.QuantitySet(this.offerNum))},t.JCCatalogBigdataProducts.prototype.InitBasketUrl=function(){switch(this.productType){case 1:case 2:this.basketUrl=this.product.addUrl;break;case 3:this.basketUrl=this.offers[this.offerNum].ADD_URL}this.basketParams={ajax_basket:"Y",rcm:"yes"},this.showQuantity&&(this.basketParams[this.basketData.quantity]=this.obQuantity.value)},t.JCCatalogBigdataProducts.prototype.FillBasketProps=function(){if(this.visual.BASKET_PROP_DIV){var t=0,s=null,e=!1,i=null;if(this.basketData.useProps&&!this.basketData.emptyProps?this.obPopupWin&&this.obPopupWin.contentContainer&&(i=this.obPopupWin.contentContainer):i=BX(this.visual.BASKET_PROP_DIV),i){if((s=i.getElementsByTagName("select"))&&s.length)for(t=0;t<s.length;t++)if(!s[t].disabled)switch(s[t].type.toLowerCase()){case"select-one":this.basketParams[s[t].name]=s[t].value,e=!0}if((s=i.getElementsByTagName("input"))&&s.length)for(t=0;t<s.length;t++)if(!s[t].disabled)switch(s[t].type.toLowerCase()){case"hidden":this.basketParams[s[t].name]=s[t].value,e=!0;break;case"radio":s[t].checked&&(this.basketParams[s[t].name]=s[t].value,e=!0)}e||(this.basketParams[this.basketData.props]=[],this.basketParams[this.basketData.props][0]=0)}}},t.JCCatalogBigdataProducts.prototype.SendToBasket=function(){this.canBuy&&(this.InitBasketUrl(),this.FillBasketProps(),this.product&&this.product.id&&JCCatalogBigdataProducts.productsByRecommendation&&JCCatalogBigdataProducts.productsByRecommendation[this.product.id]&&this.RememberProductRecommendation(JCCatalogBigdataProducts.productsByRecommendation[this.product.id],this.product.id),BX.ajax({method:"POST",dataType:"json",url:this.basketUrl,data:this.basketParams,onsuccess:BX.delegate(this.BasketResult,this)}))},t.JCCatalogBigdataProducts.prototype.RememberRecommendation=function(t,s){var e=BX.findParent(t,{className:"bigdata_recommended_products_items"}),i=BX.findChild(e,{attr:{name:"bigdata_recommendation_id"}},!0).value;this.RememberProductRecommendation(i,s)},t.JCCatalogBigdataProducts.prototype.RememberProductRecommendation=function(t,s){var e,i=BX.cookie_prefix+"_RCM_PRODUCT_LOG",o=getCookie(i),a=!1,r=[];o&&(r=o.split("."));for(var h=r.length;h--;)(e=r[h].split("-"))[0]==s?((e=r[h].split("-"))[1]=t,e[2]=BX.current_server_time,r[h]=e.join("-"),a=!0):BX.current_server_time-e[2]>2592e3&&r.splice(h,1);a||r.push([s,t,BX.current_server_time].join("-"));var n=r.join("."),u=new Date((new Date).getTime()+31536e7);document.cookie=i+"="+n+"; path=/; expires="+u.toUTCString()+"; domain="+BX.cookie_domain},t.JCCatalogBigdataProducts.prototype.Basket=function(){var t="";if(this.canBuy)switch(this.productType){case 1:case 2:this.basketData.useProps&&!this.basketData.emptyProps?(this.InitPopupWindow(),this.obPopupWin.setTitleBar({content:BX.create("div",{style:{marginRight:"30px",whiteSpace:"nowrap"},text:BX.message("CBD_TITLE_BASKET_PROPS")})}),BX(this.visual.BASKET_PROP_DIV)&&(t=BX(this.visual.BASKET_PROP_DIV).innerHTML),this.obPopupWin.setContent(t),this.obPopupWin.setButtons([new s({ownerClass:this.obProduct.parentNode.parentNode.parentNode.className,text:BX.message("CBD_BTN_MESSAGE_SEND_PROPS"),events:{click:BX.delegate(this.SendToBasket,this)}})]),this.obPopupWin.show()):this.SendToBasket();break;case 3:this.SendToBasket()}},t.JCCatalogBigdataProducts.prototype.BasketResult=function(t){var e="",i="",o="",a=!0,r=[];if(this.obPopupWin&&this.obPopupWin.close(),"object"!=typeof t)return!1;if(a="OK"===t.STATUS){switch(BX.onCustomEvent("OnBasketChange"),i=this.product.name,this.productType){case 1:case 2:o=this.product.pict.SRC;break;case 3:o=this.offers[this.offerNum].PREVIEW_PICTURE?this.offers[this.offerNum].PREVIEW_PICTURE.SRC:this.defaultPict.pict.SRC}e='<div style="width: 96%; margin: 10px 2%; text-align: center;"><img src="'+o+'" height="130" style="max-height:130px"><p>'+i+"</p></div>",r=[new s({ownerClass:this.obProduct.parentNode.parentNode.parentNode.className,text:BX.message("CBD_BTN_MESSAGE_BASKET_REDIRECT"),events:{click:BX.delegate(function(){location.href=this.basketData.basketUrl?this.basketData.basketUrl:BX.message("CBD_BASKET_URL")},this)}})]}else e=t.MESSAGE?t.MESSAGE:BX.message("CBD_BASKET_UNKNOWN_ERROR"),r=[new s({ownerClass:this.obProduct.parentNode.parentNode.parentNode.className,text:BX.message("CBD_BTN_MESSAGE_CLOSE"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})];this.InitPopupWindow(),this.obPopupWin.setTitleBar({content:BX.create("div",{style:{marginRight:"30px",whiteSpace:"nowrap"},text:a?BX.message("CBD_TITLE_SUCCESSFUL"):BX.message("CBD_TITLE_ERROR")})}),this.obPopupWin.setContent(e),this.obPopupWin.setButtons(r),this.obPopupWin.show()},t.JCCatalogBigdataProducts.prototype.InitPopupWindow=function(){this.obPopupWin||(this.obPopupWin=BX.PopupWindowManager.create("CatalogSectionBasket_"+this.visual.ID,null,{autoHide:!1,offsetLeft:0,offsetTop:0,overlay:!0,closeByEsc:!0,titleBar:!0,closeIcon:{top:"10px",right:"10px"}}))}}}(window);
/* End */
;; /* /bitrix/templates/aspro_mshop/components/bitrix/catalog.element/main/script.min.js?151963403773170*/
; /* /bitrix/templates/aspro_mshop/components/bitrix/sale.gift.product/main/script.min.js?151963403729020*/
; /* /bitrix/templates/aspro_mshop/components/bitrix/sale.gift.main.products/main/script.min.js?15174033412661*/
; /* /bitrix/templates/aspro_mshop/components/bitrix/catalog.bigdata.products/main_new/script.min.js?151740334123198*/

//# sourceMappingURL=page_8754c8a11eb40e9dd621a5652e050d4a.map.js